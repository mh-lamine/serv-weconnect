import{j as e,I as O,d as $,r,g as U,u as X,P as z,e as D,n as G,o as W,a as A,l as J,m as K,p as Q,q as M,L as E,B}from"./index-ChWRViPo.js";import{L as N,T as Y}from"./textarea-SuE7tZDF.js";import{B as Z,a as ee,b as P,c as R,d as T}from"./breadcrumb-C-7iUiSb.js";const se=({id:s,label:c,type:a,defaultValue:d,handleChange:l})=>e.jsxs("div",{children:[e.jsx(N,{htmlFor:s,children:c}),e.jsx(O,{id:s,type:a,defaultValue:d,onChange:l,className:"text-lg"})]}),y=se,te=()=>e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-2",children:[e.jsx("h1",{className:"text-3xl text-destructive",children:"Oops!"}),e.jsx("p",{children:"Une erreur s'est produite."})]}),ae=te;var L="Switch",[re,he]=$(L),[ne,oe]=re(L),_=r.forwardRef((s,c)=>{const{__scopeSwitch:a,name:d,checked:l,defaultChecked:x,required:t,disabled:n,value:m="on",onCheckedChange:p,...v}=s,[o,f]=r.useState(null),C=U(c,h=>f(h)),b=r.useRef(!1),j=o?!!o.closest("form"):!0,[u=!1,w]=X({prop:l,defaultProp:x,onChange:p});return e.jsxs(ne,{scope:a,checked:u,disabled:n,children:[e.jsx(z.button,{type:"button",role:"switch","aria-checked":u,"aria-required":t,"data-state":F(u),"data-disabled":n?"":void 0,disabled:n,value:m,...v,ref:C,onClick:D(s.onClick,h=>{w(S=>!S),j&&(b.current=h.isPropagationStopped(),b.current||h.stopPropagation())})}),j&&e.jsx(ce,{control:o,bubbles:!b.current,name:d,value:m,checked:u,required:t,disabled:n,style:{transform:"translateX(-100%)"}})]})});_.displayName=L;var V="SwitchThumb",q=r.forwardRef((s,c)=>{const{__scopeSwitch:a,...d}=s,l=oe(V,a);return e.jsx(z.span,{"data-state":F(l.checked),"data-disabled":l.disabled?"":void 0,...d,ref:c})});q.displayName=V;var ce=s=>{const{control:c,checked:a,bubbles:d=!0,...l}=s,x=r.useRef(null),t=G(a),n=W(c);return r.useEffect(()=>{const m=x.current,p=window.HTMLInputElement.prototype,o=Object.getOwnPropertyDescriptor(p,"checked").set;if(t!==a&&o){const f=new Event("click",{bubbles:d});o.call(m,a),m.dispatchEvent(f)}},[t,a,d]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...l,tabIndex:-1,ref:x,style:{...s.style,...n,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function F(s){return s?"checked":"unchecked"}var H=_,ie=q;const I=r.forwardRef(({className:s,...c},a)=>e.jsx(H,{className:A("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...c,ref:a,children:e.jsx(ie,{className:A("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));I.displayName=H.displayName;const de=/^(?:(?:\+|00)33\s?[1-9](?:[\s.-]?\d{2}){4}|0[1-9](?:[\s.-]?\d{2}){4})$/,le=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;function xe(){const[s,c]=r.useState(),[a,d]=r.useState(),[l,x]=r.useState(!0),[t,n]=r.useState(),[m,p]=r.useState(!1),[v,o]=r.useState(!1),f=J(),C=K(),b=Q();async function j(){var i;try{const g=await f.get("/api/users");c(g.data)}catch(g){d(g),((i=g.response)==null?void 0:i.status)===401&&C("/login",{state:{from:b},replace:!0})}x(!1)}r.useEffect(()=>{j()},[]);const u=i=>{n({...t,[i.target.id]:i.target.value})},w=async i=>{if(i.preventDefault(),p(!0),!Object.keys(t).some(k=>t[k]!==s[k])){n(),p(!1);return}if(t.phoneNumber&&!de.test(t.phoneNumber)){o("Le numéro de téléphone n'est pas valide"),p(!1);return}if(t.email&&!le.test(t.email)){o("L'adresse email n'est pas valide"),p(!1);return}try{await f.patch("/api/users",t),await j()}catch(k){k.response?o(k.response.data.message):o("Une erreur est survenue, veuillez réessayer plus tard")}n(),p(!1)},h=r.useRef(null),S=()=>{h.current&&(h.current.reset(),n())};return l?e.jsx(M,{className:"w-8 h-8 animate-spin flex-1"}):a?e.jsx(ae,{errMsg:a}):e.jsxs("main",{className:"w-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col gap-4",children:[e.jsx(Z,{children:e.jsxs(ee,{children:[e.jsx(P,{children:e.jsx(R,{asChild:!0,children:e.jsx(E,{to:"/",children:"Tableau de bord"})})}),e.jsx(T,{}),e.jsx(P,{children:e.jsx(R,{asChild:!0,children:e.jsx(E,{to:"/salon",children:"Salon"})})}),e.jsx(T,{}),e.jsx(P,{children:e.jsx(R,{asChild:!0,children:e.jsx(E,{to:"/salon/informations",children:"Informations"})})})]})}),e.jsx("h1",{className:"text-3xl font-semibold",children:"Mes informations"}),e.jsxs("form",{className:"space-y-2",ref:h,children:[e.jsxs("div",{className:"space-y-2 md:space-y-0 md:grid grid-cols-2 md:gap-4",children:[e.jsx(y,{id:"providerName",label:"Nom du salon",type:"text",defaultValue:s.providerName,handleChange:u}),e.jsx(y,{id:"phoneNumber",label:"Téléphone",type:"tel",defaultValue:s.phoneNumber,handleChange:u}),e.jsx(y,{id:"address",label:"Adresse",type:"text",defaultValue:s.address,handleChange:u}),e.jsx(y,{id:"email",label:"Email",type:"email",defaultValue:s.email,handleChange:u})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"autoAccept",children:"Confirmation automatique"}),e.jsxs("div",{className:"bg-white rounded-md px-3 py-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("p",{children:"Choisissez ou non d'accepter automatiquement les demandes de rendez-vous."}),e.jsx(I,{id:"autoAccept",checked:(t==null?void 0:t.autoAcceptAppointments)??s.autoAcceptAppointments,onCheckedChange:i=>{n({...t,autoAcceptAppointments:i})}})]}),e.jsxs("p",{className:"text-muted",children:["Si vous choisissez de ne pas accepter automatiquement les demandes de rendez-vous, elles auront le status ",e.jsx("b",{children:"En attente"})," tant que vous ne les aurez pas confirmées ou refusées."]})]})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"vacancyMode",className:"text-destructive",children:"Mode vacances"}),e.jsxs("div",{className:"bg-white rounded-md px-3 py-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("p",{children:"Passez en mode vacances pour ne plus recevoir de demandes de rendez-vous."}),e.jsx(I,{id:"vacancyMode",checked:(t==null?void 0:t.isInVacancyMode)??s.isInVacancyMode,onCheckedChange:i=>{n({...t,isInVacancyMode:i})},className:"data-[state=checked]:bg-destructive"})]}),e.jsx("p",{className:"text-muted",children:"En cas de fermerture temporaire de votre salon, vous pouvez activer le mode vacances pour ne plus recevoir de demandes de rendez-vous pendant un certain temps."})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(N,{htmlFor:"terms",children:"Conditions de réservation"}),e.jsx(Y,{id:"bookingTerms",type:"text",defaultValue:s.bookingTerms,onChange:u,className:"text-lg whitespace-pre-line"})]}),v&&setTimeout(()=>o(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:v}),t&&e.jsxs(e.Fragment,{children:[e.jsx(B,{onClick:w,disabled:m&&!0,children:m?e.jsx(M,{className:"animate-spin"}):"Enregistrer les modifications"}),e.jsx(B,{variant:"outline",className:"block",onClick:S,children:"Annuler les modifications"})]})]})]})}export{xe as default};
