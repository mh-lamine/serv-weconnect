import{j as e,I as O,d as $,r,g as U,u as X,P as T,e as D,n as G,o as W,a as A,l as J,m as K,p as Q,q as M,L as S,B}from"./index-0ls67huY.js";import{L as R}from"./label-D8HFsVgq.js";import{B as Y,a as Z,b as E,c as P,d as z}from"./breadcrumb-CzGRpN28.js";const ee=({id:t,label:c,type:a,defaultValue:d,handleChange:l})=>e.jsxs("div",{children:[e.jsx(R,{htmlFor:t,children:c}),e.jsx(O,{id:t,type:a,defaultValue:d,onChange:l,className:"text-lg"})]}),k=ee,se=()=>e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-2",children:[e.jsx("h1",{className:"text-3xl text-destructive",children:"Oops!"}),e.jsx("p",{children:"Une erreur s'est produite."})]}),te=se;var L="Switch",[ae,me]=$(L),[re,ne]=ae(L),_=r.forwardRef((t,c)=>{const{__scopeSwitch:a,name:d,checked:l,defaultChecked:f,required:s,disabled:n,value:m="on",onCheckedChange:u,...v}=t,[o,x]=r.useState(null),N=U(c,h=>x(h)),b=r.useRef(!1),j=o?!!o.closest("form"):!0,[p=!1,w]=X({prop:l,defaultProp:f,onChange:u});return e.jsxs(re,{scope:a,checked:p,disabled:n,children:[e.jsx(T.button,{type:"button",role:"switch","aria-checked":p,"aria-required":s,"data-state":F(p),"data-disabled":n?"":void 0,disabled:n,value:m,...v,ref:N,onClick:D(t.onClick,h=>{w(C=>!C),j&&(b.current=h.isPropagationStopped(),b.current||h.stopPropagation())})}),j&&e.jsx(oe,{control:o,bubbles:!b.current,name:d,value:m,checked:p,required:s,disabled:n,style:{transform:"translateX(-100%)"}})]})});_.displayName=L;var q="SwitchThumb",V=r.forwardRef((t,c)=>{const{__scopeSwitch:a,...d}=t,l=ne(q,a);return e.jsx(T.span,{"data-state":F(l.checked),"data-disabled":l.disabled?"":void 0,...d,ref:c})});V.displayName=q;var oe=t=>{const{control:c,checked:a,bubbles:d=!0,...l}=t,f=r.useRef(null),s=G(a),n=W(c);return r.useEffect(()=>{const m=f.current,u=window.HTMLInputElement.prototype,o=Object.getOwnPropertyDescriptor(u,"checked").set;if(s!==a&&o){const x=new Event("click",{bubbles:d});o.call(m,a),m.dispatchEvent(x)}},[s,a,d]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...l,tabIndex:-1,ref:f,style:{...t.style,...n,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function F(t){return t?"checked":"unchecked"}var H=_,ce=V;const I=r.forwardRef(({className:t,...c},a)=>e.jsx(H,{className:A("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...c,ref:a,children:e.jsx(ce,{className:A("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));I.displayName=H.displayName;const ie=/^(?:(?:\+|00)33\s?[1-9](?:[\s.-]?\d{2}){4}|0[1-9](?:[\s.-]?\d{2}){4})$/,de=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;function he(){const[t,c]=r.useState(),[a,d]=r.useState(),[l,f]=r.useState(!0),[s,n]=r.useState(),[m,u]=r.useState(!1),[v,o]=r.useState(!1),x=J(),N=K(),b=Q();async function j(){var i;try{const g=await x.get("/api/users");c(g.data)}catch(g){d(g),((i=g.response)==null?void 0:i.status)===401&&N("/login",{state:{from:b},replace:!0})}f(!1)}r.useEffect(()=>{j()},[]);const p=i=>{n({...s,[i.target.id]:i.target.value})},w=async i=>{if(i.preventDefault(),u(!0),!Object.keys(s).some(y=>s[y]!==t[y])){n(),u(!1);return}if(s.phoneNumber&&!ie.test(s.phoneNumber)){o("Le numéro de téléphone n'est pas valide"),u(!1);return}if(s.email&&!de.test(s.email)){o("L'adresse email n'est pas valide"),u(!1);return}try{await x.patch("/api/users",s),await j()}catch(y){y.response?o(y.response.data.message):o("Une erreur est survenue, veuillez réessayer plus tard")}n(),u(!1)},h=r.useRef(null),C=()=>{h.current&&(h.current.reset(),n())};return l?e.jsx(M,{className:"w-8 h-8 animate-spin flex-1"}):a?e.jsx(te,{errMsg:a}):e.jsxs("main",{className:"w-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col gap-4",children:[e.jsx(Y,{children:e.jsxs(Z,{children:[e.jsx(E,{children:e.jsx(P,{asChild:!0,children:e.jsx(S,{to:"/",children:"Tableau de bord"})})}),e.jsx(z,{}),e.jsx(E,{children:e.jsx(P,{asChild:!0,children:e.jsx(S,{to:"/salon",children:"Salon"})})}),e.jsx(z,{}),e.jsx(E,{children:e.jsx(P,{asChild:!0,children:e.jsx(S,{to:"/salon/informations",children:"Informations"})})})]})}),e.jsx("h1",{className:"text-3xl font-semibold",children:"Mes informations"}),e.jsxs("form",{className:"space-y-2",ref:h,children:[e.jsxs("div",{className:"space-y-2 md:space-y-0 md:grid grid-cols-2 md:gap-4",children:[e.jsx(k,{id:"providerName",label:"Nom du salon",type:"text",defaultValue:t.providerName,handleChange:p}),e.jsx(k,{id:"phoneNumber",label:"Téléphone",type:"tel",defaultValue:t.phoneNumber,handleChange:p}),e.jsx(k,{id:"address",label:"Adresse",type:"text",defaultValue:t.address,handleChange:p}),e.jsx(k,{id:"email",label:"Email",type:"email",defaultValue:t.email,handleChange:p})]}),e.jsxs("div",{children:[e.jsx(R,{htmlFor:"autoAccept",children:"Confirmation automatique"}),e.jsxs("div",{className:"bg-white rounded-md px-3 py-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("p",{children:"Choisissez ou non d'accepter automatiquement les demandes de rendez-vous."}),e.jsx(I,{id:"autoAccept",checked:(s==null?void 0:s.autoAcceptAppointments)??t.autoAcceptAppointments,onCheckedChange:i=>{n({...s,autoAcceptAppointments:i})}})]}),e.jsxs("p",{className:"text-muted",children:["Si vous choisissez de ne pas accepter automatiquement les demandes de rendez-vous, elles auront le status ",e.jsx("b",{children:"En attente"})," tant que vous ne les aurez pas confirmées ou refusées."]})]})]}),e.jsxs("div",{children:[e.jsx(R,{htmlFor:"vacancyMode",className:"text-destructive",children:"Mode vacances"}),e.jsxs("div",{className:"bg-white rounded-md px-3 py-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("p",{children:"Passez en mode vacances pour ne plus recevoir de demandes de rendez-vous."}),e.jsx(I,{id:"vacancyMode",checked:(s==null?void 0:s.isInVacancyMode)??t.isInVacancyMode,onCheckedChange:i=>{n({...s,isInVacancyMode:i})},className:"data-[state=checked]:bg-destructive"})]}),e.jsx("p",{className:"text-muted",children:"En cas de fermerture temporaire de votre salon, vous pouvez activer le mode vacances pour ne plus recevoir de demandes de rendez-vous pendant un certain temps."})]})]}),v&&setTimeout(()=>o(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:v}),s&&e.jsxs(e.Fragment,{children:[e.jsx(B,{onClick:w,disabled:m&&!0,children:m?e.jsx(M,{className:"animate-spin"}):"Enregistrer les modifications"}),e.jsx(B,{variant:"outline",className:"block",onClick:C,children:"Annuler les modifications"})]})]})]})}export{he as default};
