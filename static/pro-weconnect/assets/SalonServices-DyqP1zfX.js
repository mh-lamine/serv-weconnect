import{c as W,r as d,j as e,B as r,I as v,o as w,a as Y,i as Z,k as _,n as ee,L as q}from"./index-Bra0CkXf.js";import{a as k,D as S,b as F,c as z,d as M,e as E,f as T,g as L,h as O,i as V,j as P,k as R,l as I,m as B,n as U,o as $,p as H,M as se}from"./ModalAction-CUCvdTRX.js";import{L as j}from"./label-ByHrljsV.js";import{C as J,P as ie,a as re,b as ae}from"./popover-74KePm_C.js";import{B as ne,a as te,b as Q,c as G,d as K}from"./breadcrumb-DffEUiIy.js";/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=W("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=W("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),de=({createCategory:c})=>{const[f,h]=d.useState(!1),[n,a]=d.useState(),[o,t]=d.useState(!1),[m,u]=d.useState(),x=k("(min-width: 768px)"),y=N=>{const{name:C,value:g}=N.target;a({[C]:g})},l=async N=>{if(N.preventDefault(),!(n!=null&&n.name)){u("Veuillez renseigner le nom de la catégorie.");return}t(!0);try{await c(n),h(!1)}catch{u("Une erreur est survenue, veuillez réessayer plus tard.")}t(!1)};return d.useEffect(()=>{f||a()},[f]),x?e.jsxs(S,{open:f,onOpenChange:h,children:[e.jsx(F,{asChild:!0,children:e.jsx(r,{variant:"link",className:"p-0 h-min",children:"Ajouter une catégorie"})}),e.jsxs(z,{className:"sm:max-w-[425px]",children:[e.jsxs(M,{children:[e.jsx(E,{children:"Ajouter une catégorie"}),e.jsx(T,{children:"Définissez un nom pour ajouter une catégorie."})]}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{children:[e.jsx(j,{htmlFor:"name",children:"Nom"}),e.jsx(v,{id:"name",name:"name",type:"text",onChange:y})]})}),m&&setTimeout(()=>u(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:m}),e.jsx(L,{className:"sm:justify-start",children:e.jsx(O,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(r,{variant:"outline",onClick:()=>a(),children:"Annuler"}),e.jsx(r,{onClick:l,disabled:o&&!0,children:o?e.jsx(w,{className:"animate-spin"}):"Ajouter"})]})})})]})]}):e.jsxs(V,{open:f,onOpenChange:h,children:[e.jsx(P,{asChild:!0,children:e.jsx(r,{variant:"link",className:"p-0 h-min",children:"Ajouter une catégorie"})}),e.jsxs(R,{children:[e.jsxs(I,{children:[e.jsx(B,{children:"Ajouter une categorie"}),e.jsx(U,{children:"Définissez un nom pour ajouter une categorie."})]}),e.jsx("div",{className:"flex flex-col px-4 gap-2",children:e.jsxs("div",{children:[e.jsx(j,{htmlFor:"name",children:"Nom"}),e.jsx(v,{id:"name",name:"name",type:"text",onChange:y})]})}),e.jsxs($,{className:"pt-2",children:[m&&setTimeout(()=>u(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:m}),e.jsx(H,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{className:"w-full",onClick:l,disabled:o&&!0,children:o?e.jsx(w,{className:"animate-spin"}):"Ajouter"}),e.jsx(r,{className:"w-full",variant:"outline",onClick:()=>a(),children:"Annuler"})]})})]})]})]})},D=d.forwardRef(({className:c,...f},h)=>e.jsx("textarea",{className:Y("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",c),ref:h,...f}));D.displayName="Textarea";const oe=({providerCategoryId:c,createService:f})=>{const[h,n]=d.useState(!1),[a,o]=d.useState(),[t,m]=d.useState(!1),[u,x]=d.useState(),y=k("(min-width: 768px)"),l=C=>{const{name:g,value:b}=C.target,A=g==="price"||g==="duration"?parseFloat(b):b;o({...a,[g]:A})},N=async C=>{if(C.preventDefault(),!(a!=null&&a.name)||!(a!=null&&a.price)||!(a!=null&&a.duration)){x("Veuillez renseigner tous les champs.");return}m(!0);try{await f({providerCategoryId:c,...a}),n(!1)}catch{x("Une erreur est survenue, veuillez réessayer plus tard.")}m(!1)};return d.useEffect(()=>{h||o()},[h]),y?e.jsxs(S,{open:h,onOpenChange:n,children:[e.jsx(F,{asChild:!0,children:e.jsx(r,{variant:"outline",children:e.jsx(J,{})})}),e.jsxs(z,{className:"sm:max-w-[425px]",children:[e.jsxs(M,{children:[e.jsx(E,{children:"Ajouter une prestation"}),e.jsx(T,{children:"Définissez un nom, un prix et une durée pour ajouter une prestation."})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"name",children:"Nom"}),e.jsx(v,{id:"name",name:"name",type:"text",onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"price",children:"Prix (en €)"}),e.jsx(v,{id:"price",name:"price",type:"number",onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"duration",children:"Durée (en minutes)"}),e.jsx(v,{id:"duration",name:"duration",type:"number",onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"description",children:"Description"}),e.jsx(D,{id:"description",name:"description",className:"resize-none",onChange:l})]})]}),u&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:u}),e.jsx(L,{className:"sm:justify-start",children:e.jsx(O,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(r,{variant:"outline",onClick:()=>o(),children:"Annuler"}),e.jsx(r,{onClick:N,disabled:t&&!0,children:t?e.jsx(w,{className:"animate-spin"}):"Ajouter"})]})})})]})]}):e.jsxs(V,{open:h,onOpenChange:n,children:[e.jsx(P,{asChild:!0,children:e.jsx(r,{variant:"outline",children:e.jsx(J,{})})}),e.jsxs(R,{children:[e.jsxs(I,{children:[e.jsx(B,{children:"Ajouter une prestation"}),e.jsx(U,{children:"Définissez un nom, un prix et une durée pour ajouter une prestation."})]}),e.jsxs("div",{className:"flex flex-col px-4 gap-2",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"name",children:"Nom"}),e.jsx(v,{id:"name",name:"name",type:"text",onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"price",children:"Prix (en €)"}),e.jsx(v,{id:"price",name:"price",type:"number",onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"duration",children:"Durée (en minutes)"}),e.jsx(v,{id:"duration",name:"duration",type:"number",onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"description",children:"Description"}),e.jsx(D,{id:"description",name:"description",className:"resize-none",onChange:l})]})]}),e.jsxs($,{className:"pt-2",children:[u&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:u}),e.jsx(H,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{className:"w-full",onClick:N,disabled:t&&!0,children:t?e.jsx(w,{className:"animate-spin"}):"Ajouter"}),e.jsx(r,{className:"w-full",variant:"outline",onClick:()=>o(),children:"Annuler"})]})})]})]})]})},xe=({id:c,providerCategoryId:f,disableService:h})=>{const[n,a]=d.useState(!1),[o,t]=d.useState(!1),[m,u]=d.useState(),x=k("(min-width: 768px)"),y=async l=>{l.preventDefault(),t(!0);try{await h(c,f),a(!1)}catch{u("Une erreur est survenue, veuillez réessayer plus tard.")}t(!1)};return x?e.jsxs(S,{open:n,onOpenChange:a,children:[e.jsx(F,{asChild:!0,children:e.jsx(r,{variant:"destructive",children:"Retirer"})}),e.jsxs(z,{className:"sm:max-w-[425px]",children:[e.jsxs(M,{children:[e.jsx(E,{className:"text-destructive",children:"Retirer la prestation"}),e.jsx(T,{children:"Êtes-vous sûr de vouloir retirer cette prestation ?"})]}),m&&setTimeout(()=>u(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:m}),e.jsx(L,{className:"sm:justify-start",children:e.jsx(O,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(r,{variant:"outline",children:"Annuler"}),e.jsx(r,{onClick:y,variant:"destructive",disabled:o&&!0,children:o?e.jsx(w,{className:"animate-spin"}):"Retirer"})]})})})]})]}):e.jsxs(V,{open:n,onOpenChange:a,children:[e.jsx(P,{asChild:!0,children:e.jsx(r,{variant:"destructive",children:"Retirer"})}),e.jsxs(R,{children:[e.jsxs(I,{children:[e.jsx(B,{className:"text-destructive",children:"Retirer la prestation"}),e.jsx(U,{children:"Êtes-vous sûr de vouloir retirer cette prestation ?"})]}),e.jsxs($,{className:"pt-2",children:[m&&setTimeout(()=>u(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:m}),e.jsx(H,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{className:"w-full",onClick:y,variant:"destructive",disabled:o&&!0,children:o?e.jsx(w,{className:"animate-spin"}):"Retirer"}),e.jsx(r,{className:"w-full",variant:"outline",children:"Annuler"})]})})]})]})]})},ue=({prevService:c,updateService:f})=>{const[h,n]=d.useState(!1),[a,o]=d.useState(),[t,m]=d.useState(!1),[u,x]=d.useState(),y=k("(min-width: 768px)"),l=C=>{const{name:g,value:b}=C.target,A=g==="price"||g==="duration"?parseFloat(b):b;o({...a,[g]:A})},N=async C=>{if(C.preventDefault(),m(!0),!Object.keys(a).some(b=>a[b]!==c[b])){m(!1),n(!1);return}try{await f(c.id,a),n(!1)}catch{x("Une erreur est survenue, veuillez réessayer plus tard.")}m(!1)};return d.useEffect(()=>{h||o()},[h]),y?e.jsxs(S,{open:h,onOpenChange:n,children:[e.jsx(F,{asChild:!0,children:e.jsx(r,{variant:"outline",children:"Modifier"})}),e.jsxs(z,{className:"sm:max-w-[425px]",children:[e.jsxs(M,{children:[e.jsx(E,{children:"Modifier la prestation"}),e.jsx(T,{children:"Modifiez les détails de la prestation."})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"name",children:"Nom"}),e.jsx(v,{id:"name",name:"name",type:"text",defaultValue:c.name,onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"price",children:"Prix (en €)"}),e.jsx(v,{id:"price",name:"price",type:"number",defaultValue:c.price,onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"duration",children:"Durée (en minutes)"}),e.jsx(v,{id:"duration",name:"duration",type:"number",defaultValue:c.duration,onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"description",children:"Description"}),e.jsx(D,{id:"description",name:"description",className:"resize-none",defaultValue:c.description,onChange:l})]})]}),u&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:u}),e.jsx(L,{className:"sm:justify-start",children:e.jsx(O,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(r,{variant:"outline",onClick:()=>o(),children:"Annuler"}),e.jsx(r,{onClick:N,disabled:t&&!0,children:t?e.jsx(w,{className:"animate-spin"}):"Modifier"})]})})})]})]}):e.jsxs(V,{open:h,onOpenChange:n,children:[e.jsx(P,{asChild:!0,children:e.jsx(r,{variant:"outline",children:"Modifier"})}),e.jsxs(R,{children:[e.jsxs(I,{children:[e.jsx(B,{children:" Modifier la prestation"}),e.jsx(U,{children:"Modifiez les détails de la prestation."})]}),e.jsxs("div",{className:"flex flex-col px-4 gap-2",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"name",children:"Nom"}),e.jsx(v,{id:"name",name:"name",type:"text",defaultValue:c.name,onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"price",children:"Prix (en €)"}),e.jsx(v,{id:"price",name:"price",type:"number",defaultValue:c.price,onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"duration",children:"Durée (en minutes)"}),e.jsx(v,{id:"duration",name:"duration",type:"number",defaultValue:c.duration,onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"description",children:"Description"}),e.jsx(D,{id:"description",name:"description",className:"resize-none",defaultValue:c.description,onChange:l})]})]}),e.jsxs($,{className:"pt-2",children:[u&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:u}),e.jsx(H,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{className:"w-full",onClick:N,disabled:t&&!0,children:t?e.jsx(w,{className:"animate-spin"}):"Modifier"}),e.jsx(r,{className:"w-full",variant:"outline",onClick:()=>o(),children:"Annuler"})]})})]})]})]})},ve=()=>{const[c,f]=d.useState(),[h,n]=d.useState(),[a,o]=d.useState(!0),t=Z(),m=_(),u=ee();d.useEffect(()=>{x()},[]);async function x(){var s;try{const i=await t.get("/api/providerCategory/me");f(i.data.sort((p,X)=>p.name.localeCompare(X.name)))}catch(i){((s=i.response)==null?void 0:s.status)===401?m("/login",{state:{from:u},replace:!0}):setError(i)}o(!1)}async function y(s){try{await t.post("/api/providerService",s),x()}catch(i){n(i)}}async function l(s){try{await t.post("/api/providerCategory",s),x()}catch(i){n(i)}}async function N(s){try{await t.put(`/api/providerService/${s}`,{isActive:!0}),x()}catch(i){n(i)}}async function C(s){try{await t.put(`/api/providerCategory/${s}`,{isActive:!0}),x()}catch(i){n(i)}}async function g(s,i){try{await t.put(`/api/providerService/${s}`,i),x()}catch(p){n(p)}}async function b(s,i){try{await t.put(`/api/providerService/${s}`,{isActive:!1,providerCategoryId:i}),x()}catch(p){n(p)}}async function A(s){try{await t.put(`/api/providerCategory/${s}`,{isActive:!1}),x()}catch(i){n(i)}}return a?e.jsx(w,{className:"w-8 h-8 animate-spin flex-1"}):e.jsxs("main",{className:"w-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col space-y-4",children:[e.jsx(ne,{children:e.jsxs(te,{children:[e.jsx(Q,{children:e.jsx(G,{asChild:!0,children:e.jsx(q,{to:"/",children:"Tableau de bord"})})}),e.jsx(K,{}),e.jsx(Q,{children:e.jsx(G,{asChild:!0,children:e.jsx(q,{to:"/salon",children:"Salon"})})}),e.jsx(K,{}),e.jsx(Q,{children:e.jsx(G,{asChild:!0,children:e.jsx(q,{to:"/salon/availabilities",children:"Disponibilités"})})})]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold",children:"Mes prestations"}),e.jsx(de,{createCategory:l})]}),c==null?void 0:c.map(s=>s.isActive&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-medium",children:s.name}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(oe,{providerCategoryId:s.id,createService:y}),e.jsx(se,{id:s.id,action:A,actionLabel:"Retirer",variant:"destructive",title:"Retirer la catégorie",description:"Toutes les prestations associées seront retirées.",trigger:e.jsx(ce,{className:"text-destructive"}),triggerVariant:"ghost"})]})]}),e.jsx("ul",{className:"space-y-2",children:s.services.map(i=>i.isActive&&e.jsxs("li",{className:"flex items-start justify-between gap-10 w-full rounded-md p-4 pr-0 bg-gray-100",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl",children:i.name}),e.jsx("p",{children:i.description})]}),e.jsxs("div",{className:"flex flex-col-reverse gap-2 items-center md:flex-row md:gap-0",children:[e.jsxs("p",{children:[i.duration,"mn"]}),e.jsx("div",{className:"divider divider-horizontal"}),e.jsxs("p",{children:[i.price,"€"]}),e.jsxs(ie,{children:[e.jsx(re,{children:e.jsx(r,{variant:"ghost",className:"ml-4",children:e.jsx(le,{})})}),e.jsxs(ae,{className:"w-fit flex flex-col gap-2",children:[e.jsx(ue,{prevService:i,updateService:g}),e.jsx(xe,{id:i.id,providerCategoryId:s.id,disableService:b})]})]})]})]},i.id))})]},s.id)),e.jsx("div",{className:"divider divider-start text-muted",children:"Inactives"}),c.map(s=>(s.services.some(p=>!p.isActive)||!s.isActive)&&e.jsxs("div",{className:"space-y-2 text-muted",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-medium",children:s.name}),!s.isActive&&e.jsx(r,{variant:"link",onClick:()=>C(s.id),children:"Activer la catégorie"})]}),e.jsx("ul",{className:"space-y-2",children:s.services.map(p=>(!p.isActive||!s.isActive)&&e.jsx("li",{className:"flex items-center justify-between gap-4",children:e.jsxs("div",{className:"w-full rounded-md p-4 bg-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{children:p.name}),s.isActive&&!p.isActive&&e.jsx(r,{variant:"link",onClick:()=>N(p.id),children:"Activer le service"}),!s.isActive&&e.jsxs("div",{className:"flex items-center",children:[e.jsxs("p",{children:[p.duration,"mn"]}),e.jsx("div",{className:"divider divider-horizontal"}),e.jsxs("p",{children:[p.price,"€"]})]})]}),e.jsx("p",{children:p.description})]})},p.id))})]},s.id)),e.jsxs("p",{className:"text-sm text-muted",children:["La suppression des catégories et services est restreinte afin d'améliorer l'analyse de l'activité. ",e.jsx("br",{})," Pour supprimer définitivement une catégorie ou un service, veuillez"," ",e.jsxs(r,{variant:"link",className:"pl-0",children:[e.jsx("a",{href:"mailto:mlamins.ngom@gmail.com",children:"contacter le support"}),"."]})]})]})};export{ve as default};
