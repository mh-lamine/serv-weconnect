import{j as e,I as M,d as V,r as n,P as C,n as se,h as $,a as w,g as ae,u as te,e as re,o as ne,p as oe,l as ie,m as ce,q as de,s as F,L as R,B as S}from"./index-CpXBUEkS.js";import{L as v}from"./label-D7g7Ua-b.js";import{B as le,a as ue,b as I,c as P,d as z}from"./breadcrumb-oA4se1Do.js";import{T as me}from"./textarea-MtjExk3K.js";const pe=({id:s,label:r,type:a,defaultValue:o,handleChange:i})=>e.jsxs("div",{children:[e.jsx(v,{htmlFor:s,children:r}),e.jsx(M,{id:s,type:a,defaultValue:o,onChange:i,className:"text-lg"})]}),k=pe,he=()=>e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-2",children:[e.jsx("h1",{className:"text-3xl text-destructive",children:"Oops!"}),e.jsx("p",{children:"Une erreur s'est produite."})]}),fe=he;var T="Avatar",[xe,Me]=V(T),[ve,q]=xe(T),H=n.forwardRef((s,r)=>{const{__scopeAvatar:a,...o}=s,[i,d]=n.useState("idle");return e.jsx(ve,{scope:a,imageLoadingStatus:i,onImageLoadingStatusChange:d,children:e.jsx(C.span,{...o,ref:r})})});H.displayName=T;var O="AvatarImage",U=n.forwardRef((s,r)=>{const{__scopeAvatar:a,src:o,onLoadingStatusChange:i=()=>{},...d}=s,t=q(O,a),c=ge(o),l=se(u=>{i(u),t.onImageLoadingStatusChange(u)});return $(()=>{c!=="idle"&&l(c)},[c,l]),c==="loaded"?e.jsx(C.img,{...d,ref:r,src:o}):null});U.displayName=O;var G="AvatarFallback",X=n.forwardRef((s,r)=>{const{__scopeAvatar:a,delayMs:o,...i}=s,d=q(G,a),[t,c]=n.useState(o===void 0);return n.useEffect(()=>{if(o!==void 0){const l=window.setTimeout(()=>c(!0),o);return()=>window.clearTimeout(l)}},[o]),t&&d.imageLoadingStatus!=="loaded"?e.jsx(C.span,{...i,ref:r}):null});X.displayName=G;function ge(s){const[r,a]=n.useState("idle");return $(()=>{if(!s){a("error");return}let o=!0;const i=new window.Image,d=t=>()=>{o&&a(t)};return a("loading"),i.onload=d("loaded"),i.onerror=d("error"),i.src=s,()=>{o=!1}},[s]),r}var D=H,K=U,W=X;const je=n.forwardRef(({className:s,...r},a)=>e.jsx(D,{ref:a,className:w("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...r}));je.displayName=D.displayName;const be=n.forwardRef(({className:s,...r},a)=>e.jsx(K,{ref:a,className:w("aspect-square h-full w-full",s),...r}));be.displayName=K.displayName;const Ne=n.forwardRef(({className:s,...r},a)=>e.jsx(W,{ref:a,className:w("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...r}));Ne.displayName=W.displayName;var B="Switch",[ye,_e]=V(B),[we,Ce]=ye(B),J=n.forwardRef((s,r)=>{const{__scopeSwitch:a,name:o,checked:i,defaultChecked:d,required:t,disabled:c,value:l="on",onCheckedChange:u,...g}=s,[m,x]=n.useState(null),A=ae(r,f=>x(f)),j=n.useRef(!1),b=m?!!m.closest("form"):!0,[h=!1,E]=te({prop:i,defaultProp:d,onChange:u});return e.jsxs(we,{scope:a,checked:h,disabled:c,children:[e.jsx(C.button,{type:"button",role:"switch","aria-checked":h,"aria-required":t,"data-state":Z(h),"data-disabled":c?"":void 0,disabled:c,value:l,...g,ref:A,onClick:re(s.onClick,f=>{E(L=>!L),b&&(j.current=f.isPropagationStopped(),j.current||f.stopPropagation())})}),b&&e.jsx(Se,{control:m,bubbles:!j.current,name:o,value:l,checked:h,required:t,disabled:c,style:{transform:"translateX(-100%)"}})]})});J.displayName=B;var Q="SwitchThumb",Y=n.forwardRef((s,r)=>{const{__scopeSwitch:a,...o}=s,i=Ce(Q,a);return e.jsx(C.span,{"data-state":Z(i.checked),"data-disabled":i.disabled?"":void 0,...o,ref:r})});Y.displayName=Q;var Se=s=>{const{control:r,checked:a,bubbles:o=!0,...i}=s,d=n.useRef(null),t=ne(a),c=oe(r);return n.useEffect(()=>{const l=d.current,u=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(u,"checked").set;if(t!==a&&m){const x=new Event("click",{bubbles:o});m.call(l,a),l.dispatchEvent(x)}},[t,a,o]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...i,tabIndex:-1,ref:d,style:{...s.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Z(s){return s?"checked":"unchecked"}var ee=J,ke=Y;const _=n.forwardRef(({className:s,...r},a)=>e.jsx(ee,{className:w("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...r,ref:a,children:e.jsx(ke,{className:w("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));_.displayName=ee.displayName;const Ae=/^(?:(?:\+|00)33\s?[1-9](?:[\s.-]?\d{2}){4}|0[1-9](?:[\s.-]?\d{2}){4})$/,Ee=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;function Te(){const[s,r]=n.useState(),[a,o]=n.useState(),[i,d]=n.useState(!0),[t,c]=n.useState(),[l,u]=n.useState(!1),[g,m]=n.useState(!1),x=ie(),A=ce(),j=de();async function b(){var p;try{const N=await x.get("/api/users");r(N.data)}catch(N){o(N),((p=N.response)==null?void 0:p.status)===401&&A("/login",{state:{from:j},replace:!0})}d(!1)}n.useEffect(()=>{b()},[]);const h=p=>{c({...t,[p.target.id]:p.target.value})},E=async p=>{if(p.preventDefault(),u(!0),!Object.keys(t).some(y=>t[y]!==s[y])){c(),u(!1);return}if(t.phoneNumber&&!Ae.test(t.phoneNumber)){m("Le numéro de téléphone n'est pas valide"),u(!1);return}if(t.email&&!Ee.test(t.email)){m("L'adresse email n'est pas valide"),u(!1);return}try{await x.patch("/api/users",t),await b()}catch(y){y.response?m(y.response.data.message):m("Une erreur est survenue, veuillez réessayer plus tard")}c(),u(!1)},f=n.useRef(null),L=()=>{f.current&&(f.current.reset(),c())};return i?e.jsx(F,{className:"w-8 h-8 animate-spin flex-1"}):a?e.jsx(fe,{errMsg:a}):e.jsxs("main",{className:"w-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col gap-4",children:[e.jsx(le,{children:e.jsxs(ue,{children:[e.jsx(I,{children:e.jsx(P,{asChild:!0,children:e.jsx(R,{to:"/",children:"Tableau de bord"})})}),e.jsx(z,{}),e.jsx(I,{children:e.jsx(P,{asChild:!0,children:e.jsx(R,{to:"/salon",children:"Salon"})})}),e.jsx(z,{}),e.jsx(I,{children:e.jsx(P,{asChild:!0,children:e.jsx(R,{to:"/salon/informations",children:"Informations"})})})]})}),e.jsx("h1",{className:"text-3xl font-semibold",children:"Mes informations"}),e.jsxs("div",{className:"space-y-2 md:space-y-0 md:grid grid-cols-2 md:gap-4",children:[e.jsx(S,{asChild:!0,children:e.jsx(v,{htmlFor:"profile",className:" w-full",children:"Changer ma photo de profil"})}),e.jsx(M,{className:"hidden",type:"file",id:"profile"}),e.jsx(S,{asChild:!0,children:e.jsx(v,{htmlFor:"cover",className:" w-full",children:"Changer mes photos de couverture"})}),e.jsx(M,{className:"hidden",type:"file",id:"cover"})]}),e.jsxs("form",{className:"space-y-2",ref:f,children:[e.jsxs("div",{className:"space-y-2 md:space-y-0 md:grid grid-cols-2 md:gap-4",children:[e.jsx(k,{id:"providerName",label:"Nom du salon",type:"text",defaultValue:s.providerName,handleChange:h}),e.jsx(k,{id:"phoneNumber",label:"Téléphone",type:"tel",defaultValue:s.phoneNumber,handleChange:h}),e.jsx(k,{id:"address",label:"Adresse",type:"text",defaultValue:s.address,handleChange:h}),e.jsx(k,{id:"email",label:"Email",type:"email",defaultValue:s.email,handleChange:h})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"autoAccept",children:"Confirmation automatique"}),e.jsxs("div",{className:"bg-white rounded-md px-3 py-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("p",{children:"Choisissez ou non d'accepter automatiquement les demandes de rendez-vous."}),e.jsx(_,{id:"autoAccept",checked:(t==null?void 0:t.autoAcceptAppointments)??s.autoAcceptAppointments,onCheckedChange:p=>{c({...t,autoAcceptAppointments:p})}})]}),e.jsxs("p",{className:"text-muted",children:["Si vous choisissez de ne pas accepter automatiquement les demandes de rendez-vous, elles auront le status ",e.jsx("b",{children:"En attente"})," tant que vous ne les aurez pas confirmées ou refusées."]})]})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"vacancyMode",className:"text-destructive",children:"Mode vacances"}),e.jsxs("div",{className:"bg-white rounded-md px-3 py-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("p",{children:"Passez en mode vacances pour ne plus recevoir de demandes de rendez-vous."}),e.jsx(_,{id:"vacancyMode",checked:(t==null?void 0:t.isInVacancyMode)??s.isInVacancyMode,onCheckedChange:p=>{c({...t,isInVacancyMode:p})},className:"data-[state=checked]:bg-destructive"})]}),e.jsx("p",{className:"text-muted",children:"En cas de fermerture temporaire de votre salon, vous pouvez activer le mode vacances pour ne plus recevoir de demandes de rendez-vous pendant un certain temps."})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(v,{htmlFor:"terms",children:"Conditions de réservation"}),e.jsx(me,{id:"bookingTerms",type:"text",defaultValue:s.bookingTerms,onChange:h,className:"text-lg whitespace-pre-line"})]}),g&&setTimeout(()=>m(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:g}),t&&e.jsxs(e.Fragment,{children:[e.jsx(S,{onClick:E,disabled:l&&!0,children:l?e.jsx(F,{className:"animate-spin"}):"Enregistrer les modifications"}),e.jsx(S,{variant:"outline",className:"block",onClick:L,children:"Annuler les modifications"})]})]})]})}export{Te as default};
