import{c as ie,r as d,j as e,B as a,I as v,s as D,J as w,l as re,m as ae,q as ne,L as q}from"./index-BLseAJzI.js";import{u as A,D as k,a as S,b as F,c as M,d as z,e as $,f as T,g as V,h as L,i as O,j as E,k as P,l as R,m as H,n as I,o as B,M as te}from"./ModalAction-g7X7acie.js";import{L as j,T as U}from"./textarea-CddHwwRd.js";import{c as se,P as G,a as K,b as W,d as X}from"./popover-DCufzFgs.js";import{C as Y}from"./circle-plus-Bj47Fwry.js";import{B as le,a as ce,b as Q,c as _,d as Z}from"./breadcrumb-BUF4MJjg.js";import"./index-DSrlfwCH.js";/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=ie("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),de=({createCategory:t})=>{const[g,m]=d.useState(!1),[o,i]=d.useState(),[c,u]=d.useState(!1),[n,x]=d.useState(),p=A("(min-width: 768px)"),f=C=>{const{name:b,value:N}=C.target;i({[b]:N})},l=async C=>{if(C.preventDefault(),!(o!=null&&o.name)){x("Veuillez renseigner le nom de la catégorie.");return}u(!0);try{await t(o),m(!1)}catch{x("Une erreur est survenue, veuillez contacter le support.")}u(!1)};return d.useEffect(()=>{g||i()},[g]),p?e.jsxs(k,{open:g,onOpenChange:m,children:[e.jsx(S,{asChild:!0,children:e.jsx(a,{variant:"link",className:"py-0",children:"Ajouter une catégorie"})}),e.jsxs(F,{className:"sm:max-w-[425px]",children:[e.jsxs(M,{children:[e.jsx(z,{children:"Ajouter une catégorie"}),e.jsx($,{children:"Définissez un nom pour ajouter une catégorie."})]}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{children:[e.jsx(j,{htmlFor:"name",children:"Nom"}),e.jsx(v,{id:"name",name:"name",type:"text",onChange:f})]})}),n&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:n}),e.jsx(T,{className:"sm:justify-start",children:e.jsx(V,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(a,{variant:"outline",onClick:()=>i(),children:"Annuler"}),e.jsx(a,{onClick:l,disabled:c&&!0,children:c?e.jsx(D,{className:"animate-spin"}):"Ajouter"})]})})})]})]}):e.jsxs(L,{open:g,onOpenChange:m,children:[e.jsx(O,{asChild:!0,children:e.jsx(a,{variant:"link",className:"py-0",children:"Ajouter une catégorie"})}),e.jsxs(E,{children:[e.jsxs(P,{children:[e.jsx(R,{children:"Ajouter une categorie"}),e.jsx(H,{children:"Définissez un nom pour ajouter une categorie."})]}),e.jsx("div",{className:"flex flex-col px-4 gap-2",children:e.jsxs("div",{children:[e.jsx(j,{htmlFor:"name",children:"Nom"}),e.jsx(v,{id:"name",name:"name",type:"text",onChange:f})]})}),e.jsxs(I,{className:"pt-2",children:[n&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:n}),e.jsx(B,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{className:"w-full",onClick:l,disabled:c&&!0,children:c?e.jsx(D,{className:"animate-spin"}):"Ajouter"}),e.jsx(a,{className:"w-full",variant:"outline",onClick:()=>i(),children:"Annuler"})]})})]})]})]})},oe=({providerCategoryId:t,createService:g})=>{const[m,o]=d.useState(!1),[i,c]=d.useState(),[u,n]=d.useState(!1),[x,p]=d.useState(),f=A("(min-width: 768px)"),l=b=>{const{name:N,value:y}=b.target,s=N==="price"?parseFloat(y):N==="duration"?parseFloat(se(y)):y;c({...i,[N]:s})},C=async b=>{if(b.preventDefault(),!(i!=null&&i.name)||!(i!=null&&i.price)||!(i!=null&&i.duration)){p("Veuillez renseigner tous les champs.");return}n(!0);try{await g({providerCategoryId:t,...i}),o(!1)}catch{p("Une erreur est survenue, veuillez contacter le support.")}n(!1)};return d.useEffect(()=>{m||c()},[m]),f?e.jsxs(k,{open:m,onOpenChange:o,children:[e.jsx(S,{asChild:!0,children:e.jsx(a,{variant:"outline",children:e.jsx(Y,{})})}),e.jsxs(F,{className:"sm:max-w-[425px]",children:[e.jsxs(M,{children:[e.jsx(z,{children:"Ajouter une prestation"}),e.jsx($,{children:"Définissez un nom, un prix et une durée pour ajouter une prestation."})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"name",children:"Nom"}),e.jsx(v,{id:"name",name:"name",type:"text",onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"price",children:"Prix (sans €)"}),e.jsx(v,{id:"price",name:"price",type:"number",onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"duration",children:"Durée (heure:minute)"}),e.jsx(v,{id:"duration",name:"duration",type:"time",defaultValue:"00:00",onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"description",children:"Description"}),e.jsx(U,{id:"description",name:"description",className:"resize-none",onChange:l})]})]}),x&&setTimeout(()=>p(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:x}),e.jsx(T,{className:"sm:justify-start",children:e.jsx(V,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(a,{variant:"outline",onClick:()=>c(),children:"Annuler"}),e.jsx(a,{onClick:C,disabled:u&&!0,children:u?e.jsx(D,{className:"animate-spin"}):"Ajouter"})]})})})]})]}):e.jsxs(L,{open:m,onOpenChange:o,children:[e.jsx(O,{asChild:!0,children:e.jsx(a,{variant:"outline",children:e.jsx(Y,{})})}),e.jsxs(E,{children:[e.jsxs(P,{children:[e.jsx(R,{children:"Ajouter une prestation"}),e.jsx(H,{children:"Définissez un nom, un prix et une durée pour ajouter une prestation."})]}),e.jsxs("div",{className:"flex flex-col px-4 gap-2",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"name",children:"Nom"}),e.jsx(v,{id:"name",name:"name",type:"text",onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"price",children:"Prix (en €)"}),e.jsx(v,{id:"price",name:"price",type:"number",onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"duration",children:"Durée (heure:minute)"}),e.jsx(v,{id:"duration",name:"duration",type:"time",defaultValue:"00:00",onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"description",children:"Description"}),e.jsx(U,{id:"description",name:"description",className:"resize-none",onChange:l})]})]}),e.jsxs(I,{className:"pt-2",children:[x&&setTimeout(()=>p(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:x}),e.jsx(B,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{className:"w-full",onClick:C,disabled:u&&!0,children:u?e.jsx(D,{className:"animate-spin"}):"Ajouter"}),e.jsx(a,{className:"w-full",variant:"outline",onClick:()=>c(),children:"Annuler"})]})})]})]})]})},ue=({id:t,providerCategoryId:g,disableService:m})=>{const[o,i]=d.useState(!1),[c,u]=d.useState(!1),[n,x]=d.useState(),p=A("(min-width: 768px)"),f=async l=>{l.preventDefault(),u(!0);try{await m(t,g),i(!1)}catch{x("Une erreur est survenue, veuillez contacter le support.")}u(!1)};return p?e.jsxs(k,{open:o,onOpenChange:i,children:[e.jsx(S,{asChild:!0,children:e.jsx(a,{variant:"destructive",children:"Retirer"})}),e.jsxs(F,{className:"sm:max-w-[425px]",children:[e.jsxs(M,{children:[e.jsx(z,{className:"text-destructive",children:"Retirer la prestation"}),e.jsx($,{children:"Êtes-vous sûr de vouloir retirer cette prestation ?"})]}),n&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:n}),e.jsx(T,{className:"sm:justify-start",children:e.jsx(V,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(a,{variant:"outline",children:"Annuler"}),e.jsx(a,{onClick:f,variant:"destructive",disabled:c&&!0,children:c?e.jsx(D,{className:"animate-spin"}):"Retirer"})]})})})]})]}):e.jsxs(L,{open:o,onOpenChange:i,children:[e.jsx(O,{asChild:!0,children:e.jsx(a,{variant:"destructive",children:"Retirer"})}),e.jsxs(E,{children:[e.jsxs(P,{children:[e.jsx(R,{className:"text-destructive",children:"Retirer la prestation"}),e.jsx(H,{children:"Êtes-vous sûr de vouloir retirer cette prestation ?"})]}),e.jsxs(I,{className:"pt-2",children:[n&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:n}),e.jsx(B,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{className:"w-full",onClick:f,variant:"destructive",disabled:c&&!0,children:c?e.jsx(D,{className:"animate-spin"}):"Retirer"}),e.jsx(a,{className:"w-full",variant:"outline",children:"Annuler"})]})})]})]})]})},xe=({category:t,updateCategory:g})=>{const[m,o]=d.useState(!1),[i,c]=d.useState(),[u,n]=d.useState(!1),x=A("(min-width: 768px)"),p=async f=>{if(f.preventDefault(),n(!0),!(i!==t.name)){n(!1),o(!1),w("Aucun changement n'a été effectué.");return}try{await g(t.id,{name:i}),o(!1)}catch{w.error("Une erreur est survenue, veuillez contacter le support.")}n(!1)};return x?e.jsxs(k,{open:m,onOpenChange:o,children:[e.jsx(S,{asChild:!0,children:e.jsx(a,{variant:"outline",children:"Modifier"})}),e.jsxs(F,{className:"sm:max-w-[425px]",children:[e.jsx(M,{children:e.jsx(z,{children:"Modifier le nom de la catégorie"})}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"name",children:"Nom"}),e.jsx(v,{id:"name",name:"name",type:"text",defaultValue:t.name,onChange:f=>c(f.target.value)})]}),e.jsx(T,{className:"sm:justify-start",children:e.jsx(V,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(a,{onClick:p,disabled:u&&!0,children:u?e.jsx(D,{className:"animate-spin"}):"Modifier"}),e.jsx(a,{variant:"outline",onClick:()=>setCategory(),children:"Annuler"})]})})})]})]}):e.jsxs(L,{open:m,onOpenChange:o,children:[e.jsx(O,{asChild:!0,children:e.jsx(a,{variant:"outline",children:"Modifier"})}),e.jsxs(E,{children:[e.jsx(P,{children:e.jsx(R,{children:" Modifier le nom de la catégorie"})}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"name",children:"Nom"}),e.jsx(v,{id:"name",name:"name",type:"text",defaultValue:t.name,onChange:f=>c(f.target.value)})]}),e.jsx(I,{className:"pt-2",children:e.jsx(B,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{className:"w-full",onClick:p,disabled:u&&!0,children:u?e.jsx(D,{className:"animate-spin"}):"Modifier"}),e.jsx(a,{className:"w-full",variant:"outline",onClick:()=>setCategory(),children:"Annuler"})]})})})]})]})},he=({prevService:t,updateService:g})=>{const[m,o]=d.useState(!1),[i,c]=d.useState(),[u,n]=d.useState(!1),[x,p]=d.useState(),f=A("(min-width: 768px)"),l=b=>{const{name:N,value:y}=b.target,s=N==="price"?parseFloat(y):N==="duration"?parseFloat(se(y)):y;c({...i,[N]:s})},C=async b=>{if(b.preventDefault(),n(!0),!Object.keys(i).some(y=>i[y]!==t[y])){n(!1),o(!1);return}try{await g(t.id,i),o(!1)}catch{p("Une erreur est survenue, veuillez contacter le support.")}n(!1)};return d.useEffect(()=>{m||c()},[m]),f?e.jsxs(k,{open:m,onOpenChange:o,children:[e.jsx(S,{asChild:!0,children:e.jsx(a,{variant:"outline",children:"Modifier"})}),e.jsxs(F,{className:"sm:max-w-[425px]",children:[e.jsxs(M,{children:[e.jsx(z,{children:"Modifier la prestation"}),e.jsx($,{children:"Modifiez les détails de la prestation."})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"name",children:"Nom"}),e.jsx(v,{id:"name",name:"name",type:"text",defaultValue:t.name,onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"price",children:"Prix (sans €)"}),e.jsx(v,{id:"price",name:"price",type:"number",defaultValue:t.price,onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"duration",children:"Durée (heure:minute)"}),e.jsx(v,{id:"duration",name:"duration",type:"time",defaultValue:t.duration,onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"description",children:"Description"}),e.jsx(U,{id:"description",name:"description",className:"resize-none",defaultValue:t.description,onChange:l})]})]}),x&&setTimeout(()=>p(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:x}),e.jsx(T,{className:"sm:justify-start",children:e.jsx(V,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(a,{onClick:C,disabled:u&&!0,children:u?e.jsx(D,{className:"animate-spin"}):"Modifier"}),e.jsx(a,{variant:"outline",onClick:()=>c(),children:"Annuler"})]})})})]})]}):e.jsxs(L,{open:m,onOpenChange:o,children:[e.jsx(O,{asChild:!0,children:e.jsx(a,{variant:"outline",children:"Modifier"})}),e.jsxs(E,{children:[e.jsxs(P,{children:[e.jsx(R,{children:" Modifier la prestation"}),e.jsx(H,{children:"Modifiez les détails de la prestation."})]}),e.jsxs("div",{className:"flex flex-col px-4 gap-2",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"name",children:"Nom"}),e.jsx(v,{id:"name",name:"name",type:"text",defaultValue:t.name,onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"price",children:"Prix (en €)"}),e.jsx(v,{id:"price",name:"price",type:"number",defaultValue:t.price,onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"duration",children:"Durée (heure:minute)"}),e.jsx(v,{id:"duration",name:"duration",type:"time",onChange:l})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"description",children:"Description"}),e.jsx(U,{id:"description",name:"description",className:"resize-none",defaultValue:t.description,onChange:l})]})]}),e.jsxs(I,{className:"pt-2",children:[x&&setTimeout(()=>p(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:x}),e.jsx(B,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{className:"w-full",onClick:C,disabled:u&&!0,children:u?e.jsx(D,{className:"animate-spin"}):"Modifier"}),e.jsx(a,{className:"w-full",variant:"outline",onClick:()=>c(),children:"Annuler"})]})})]})]})]})},Ne=()=>{const[t,g]=d.useState(),[m,o]=d.useState(!0),i=re(),c=ae(),u=ne();d.useEffect(()=>{n()},[]);async function n(){var s;try{const r=await i.get("/api/providerCategory/me");g(r.data.sort((h,J)=>h.name.localeCompare(J.name)))}catch(r){((s=r.response)==null?void 0:s.status)===401?c("/login",{state:{from:u},replace:!0}):w.error(r.message)}o(!1)}async function x(s){try{await i.post("/api/providerService",s),n()}catch(r){w.error(r.message)}}async function p(s){try{await i.post("/api/providerCategory",s),n()}catch(r){w.error(r.message)}}async function f(s){try{await i.put(`/api/providerService/${s}`,{isActive:!0}),n()}catch(r){w.error(r.message)}}async function l(s){try{await i.put(`/api/providerCategory/${s}`,{isActive:!0}),n()}catch(r){w.error(r.message)}}async function C(s,r){try{await i.put(`/api/providerService/${s}`,r),n(),w.success("Service mis à jour")}catch(h){w.error(h.message)}}async function b(s,r){try{await i.put(`/api/providerCategory/${s}`,r),n(),w.success("Catégorie mise à jour")}catch(h){w.error(h.message)}}async function N(s,r){try{await i.put(`/api/providerService/${s}`,{isActive:!1,providerCategoryId:r}),n()}catch(h){w.error(h.message)}}async function y(s){try{await i.put(`/api/providerCategory/${s}`,{isActive:!1}),n()}catch(r){w.error(r.message)}}return m?e.jsx(D,{className:"w-8 h-8 animate-spin flex-1"}):e.jsxs("main",{className:"w-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col space-y-4",children:[e.jsx(le,{children:e.jsxs(ce,{children:[e.jsx(Q,{children:e.jsx(_,{asChild:!0,children:e.jsx(q,{to:"/",children:"Tableau de bord"})})}),e.jsx(Z,{}),e.jsx(Q,{children:e.jsx(_,{asChild:!0,children:e.jsx(q,{to:"/salon",children:"Salon"})})}),e.jsx(Z,{}),e.jsx(Q,{children:e.jsx(_,{asChild:!0,children:e.jsx(q,{to:"/salon/availabilities",children:"Disponibilités"})})})]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold",children:"Mes prestations"}),e.jsx(de,{createCategory:p})]}),t==null?void 0:t.sort((s,r)=>s.name-r.name).map(s=>s.isActive&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-medium",children:s.name}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(oe,{providerCategoryId:s.id,createService:x}),e.jsxs(G,{children:[e.jsx(K,{asChild:!0,children:e.jsx(a,{variant:"ghost",className:"ml-4",children:e.jsx(ee,{})})}),e.jsxs(W,{align:"end",className:"w-fit flex flex-col gap-2",children:[e.jsx(xe,{category:s,updateCategory:b}),e.jsx(te,{id:s.id,action:y,actionLabel:"Retirer",variant:"destructive",title:"Retirer la catégorie",description:"Toutes les prestations associées seront retirées.",trigger:"Retirer",triggerVariant:"destructive"})]})]})]})]}),e.jsx("ul",{className:"space-y-2",children:s.services.sort((r,h)=>r.name-h.name).map(r=>r.isActive&&e.jsxs("li",{className:"flex items-start justify-between gap-10 w-full rounded-md p-4 pr-0 bg-gray-100",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl",children:r.name}),e.jsx("p",{children:r.description})]}),e.jsxs("div",{className:"flex flex-col-reverse gap-2 items-center md:flex-row md:gap-0",children:[e.jsx("p",{children:X(r.duration)}),e.jsx("div",{className:"divider divider-horizontal"}),e.jsxs("p",{children:[r.price,"€"]}),e.jsxs(G,{children:[e.jsx(K,{asChild:!0,children:e.jsx(a,{variant:"ghost",className:"ml-4",children:e.jsx(ee,{})})}),e.jsxs(W,{align:"end",className:"w-fit flex flex-col gap-2",children:[e.jsx(he,{prevService:r,updateService:C}),e.jsx(ue,{id:r.id,providerCategoryId:s.id,disableService:N})]})]})]})]},r.id))})]},s.id)),e.jsx("div",{className:"divider divider-start text-muted",children:"Inactives"}),t.sort((s,r)=>s.name-r.name).map(s=>(s.services.some(h=>!h.isActive)||!s.isActive)&&e.jsxs("div",{className:"space-y-2 text-muted",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-medium",children:s.name}),!s.isActive&&e.jsx(a,{variant:"link",onClick:()=>l(s.id),children:"Activer la catégorie"})]}),e.jsx("ul",{className:"space-y-2",children:s.services.sort((h,J)=>h.name-J.name).map(h=>(!h.isActive||!s.isActive)&&e.jsx("li",{className:"flex items-center justify-between gap-4",children:e.jsxs("div",{className:"w-full rounded-md p-4 bg-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{children:h.name}),s.isActive&&!h.isActive&&e.jsx(a,{variant:"link",onClick:()=>f(h.id),children:"Activer le service"}),!s.isActive&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("p",{children:X(h.duration)}),e.jsx("div",{className:"divider divider-horizontal"}),e.jsxs("p",{children:[h.price,"€"]})]})]}),e.jsx("p",{children:h.description})]})},h.id))})]},s.id)),e.jsxs("p",{className:"text-sm text-muted",children:["La suppression des catégories et services est restreinte afin d'améliorer l'analyse de l'activité. ",e.jsx("br",{})," Pour supprimer définitivement une catégorie ou un service, veuillez"," ",e.jsxs(a,{variant:"link",className:"pl-0",children:[e.jsx("a",{href:"https://www.weconnect-rdv.fr/provider/cm13ksbde0000g98rx8rpbwte",target:"_blank",rel:"noreferrer noopener",children:"contacter le support"}),"."]})]})]})};export{Ne as default};
