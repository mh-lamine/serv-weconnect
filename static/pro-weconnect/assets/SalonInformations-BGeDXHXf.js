import{j as e,I as V,d as q,r as n,g as F,u as H,P as I,e as O,l as $,m as U,a as A,i as X,k as D,n as G,o as M,B as E}from"./index-Cb_7rQLy.js";import{L as S}from"./label-Cw_NeveI.js";const W=({id:t,label:c,type:a,defaultValue:d,handleChange:l})=>e.jsxs("div",{children:[e.jsx(S,{htmlFor:t,children:c}),e.jsx(V,{id:t,type:a,defaultValue:d,onChange:l,className:"text-lg"})]}),N=W,J=()=>e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-2",children:[e.jsx("h1",{className:"text-3xl text-destructive",children:"Oops!"}),e.jsx("p",{children:"Une erreur s'est produite."})]}),K=J;var R="Switch",[Q,oe]=q(R),[Y,Z]=Q(R),z=n.forwardRef((t,c)=>{const{__scopeSwitch:a,name:d,checked:l,defaultChecked:f,required:s,disabled:r,value:m="on",onCheckedChange:u,...v}=t,[o,x]=n.useState(null),k=F(c,h=>x(h)),b=n.useRef(!1),g=o?!!o.closest("form"):!0,[p=!1,w]=H({prop:l,defaultProp:f,onChange:u});return e.jsxs(Y,{scope:a,checked:p,disabled:r,children:[e.jsx(I.button,{type:"button",role:"switch","aria-checked":p,"aria-required":s,"data-state":T(p),"data-disabled":r?"":void 0,disabled:r,value:m,...v,ref:k,onClick:O(t.onClick,h=>{w(C=>!C),g&&(b.current=h.isPropagationStopped(),b.current||h.stopPropagation())})}),g&&e.jsx(ee,{control:o,bubbles:!b.current,name:d,value:m,checked:p,required:s,disabled:r,style:{transform:"translateX(-100%)"}})]})});z.displayName=R;var L="SwitchThumb",_=n.forwardRef((t,c)=>{const{__scopeSwitch:a,...d}=t,l=Z(L,a);return e.jsx(I.span,{"data-state":T(l.checked),"data-disabled":l.disabled?"":void 0,...d,ref:c})});_.displayName=L;var ee=t=>{const{control:c,checked:a,bubbles:d=!0,...l}=t,f=n.useRef(null),s=$(a),r=U(c);return n.useEffect(()=>{const m=f.current,u=window.HTMLInputElement.prototype,o=Object.getOwnPropertyDescriptor(u,"checked").set;if(s!==a&&o){const x=new Event("click",{bubbles:d});o.call(m,a),m.dispatchEvent(x)}},[s,a,d]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...l,tabIndex:-1,ref:f,style:{...t.style,...r,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function T(t){return t?"checked":"unchecked"}var B=z,se=_;const P=n.forwardRef(({className:t,...c},a)=>e.jsx(B,{className:A("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...c,ref:a,children:e.jsx(se,{className:A("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));P.displayName=B.displayName;const te=/^(?:(?:\+|00)33\s?[1-9](?:[\s.-]?\d{2}){4}|0[1-9](?:[\s.-]?\d{2}){4})$/,ae=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;function ce(){const[t,c]=n.useState(),[a,d]=n.useState(),[l,f]=n.useState(!0),[s,r]=n.useState(),[m,u]=n.useState(!1),[v,o]=n.useState(!1),x=X(),k=D(),b=G();async function g(){var i;try{const j=await x.get("/api/users");c(j.data)}catch(j){d(j),((i=j.response)==null?void 0:i.status)===401&&k("/login",{state:{from:b},replace:!0})}f(!1)}n.useEffect(()=>{g()},[]);const p=i=>{r({...s,[i.target.id]:i.target.value})},w=async i=>{if(i.preventDefault(),u(!0),!Object.keys(s).some(y=>s[y]!==t[y])){r(),u(!1);return}if(s.phoneNumber&&!te.test(s.phoneNumber)){o("Le numéro de téléphone n'est pas valide"),u(!1);return}if(s.email&&!ae.test(s.email)){o("L'adresse email n'est pas valide"),u(!1);return}try{await x.patch("/api/users",s),await g()}catch(y){y.response?o(y.response.data.message):o("Une erreur est survenue, veuillez réessayer plus tard")}r(),u(!1)},h=n.useRef(null),C=()=>{h.current&&(h.current.reset(),r())};return l?e.jsx(M,{className:"w-8 h-8 animate-spin flex-1"}):a?e.jsx(K,{errMsg:a}):e.jsxs("main",{className:"w-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col gap-4",children:[e.jsx(E,{variant:"link",className:"justify-start h-0 p-0",onClick:()=>k(-1),children:"Retour"}),e.jsx("h1",{className:"text-3xl font-semibold",children:"Mes informations"}),e.jsxs("form",{className:"space-y-2",ref:h,children:[e.jsxs("div",{className:"space-y-2 md:space-y-0 md:grid grid-cols-2 md:gap-4",children:[e.jsx(N,{id:"providerName",label:"Nom du salon",type:"text",defaultValue:t.providerName,handleChange:p}),e.jsx(N,{id:"phoneNumber",label:"Téléphone",type:"tel",defaultValue:t.phoneNumber,handleChange:p}),e.jsx(N,{id:"address",label:"Adresse",type:"text",defaultValue:t.address,handleChange:p}),e.jsx(N,{id:"email",label:"Email",type:"email",defaultValue:t.email,handleChange:p})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"autoAccept",children:"Confirmation automatique"}),e.jsxs("div",{className:"bg-white rounded-md px-3 py-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("p",{children:"Choisissez ou non d'accepter automatiquement les demandes de rendez-vous."}),e.jsx(P,{id:"autoAccept",checked:(s==null?void 0:s.autoAcceptAppointments)??t.autoAcceptAppointments,onCheckedChange:i=>{r({...s,autoAcceptAppointments:i})}})]}),e.jsxs("p",{className:"text-muted",children:["Si vous choisissez de ne pas accepter automatiquement les demandes de rendez-vous, elles auront le status ",e.jsx("b",{children:"En attente"})," tant que vous ne les aurez pas confirmées ou refusées."]})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"vacancyMode",className:"text-destructive",children:"Mode vacances"}),e.jsxs("div",{className:"bg-white rounded-md px-3 py-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("p",{children:"Passez en mode vacances pour ne plus recevoir de demandes de rendez-vous."}),e.jsx(P,{id:"vacancyMode",checked:(s==null?void 0:s.isInVacancyMode)??t.isInVacancyMode,onCheckedChange:i=>{r({...s,isInVacancyMode:i})},className:"data-[state=checked]:bg-destructive"})]}),e.jsx("p",{className:"text-muted",children:"En cas de fermerture temporaire de votre salon, vous pouvez activer le mode vacances pour ne plus recevoir de demandes de rendez-vous pendant un certain temps."})]})]}),v&&setTimeout(()=>o(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:v}),s&&e.jsxs(e.Fragment,{children:[e.jsx(E,{onClick:w,disabled:m&&!0,children:m?e.jsx(M,{className:"animate-spin"}):"Enregistrer les modifications"}),e.jsx(E,{variant:"outline",className:"block",onClick:C,children:"Annuler les modifications"})]})]})]})}export{ce as default};
