import{r as t,j as e,B as c,I as N,v as A,w as L,x as o,n as R,J as p,a as m,e as H,m as O,L as j}from"./index-7qE4wMN6.js";import{a as P}from"./axiosPrivate-BhUmTwXX.js";import{u as z,D as J,a as $,b as G,c as V,d as U,j as _,k as q,l as Q,e as K,f as W,g as X,h as Y,i as Z,m as ee,n as se,o as ae}from"./drawer-C0D-Lm8d.js";import{L as u}from"./label-DCCLqaws.js";import{B as re,a as le,b as T,c as D,d as S}from"./breadcrumb-BMJETWS4.js";import{P as ne,a as te,b as ie}from"./popover-D50s3LJ5.js";import{E as oe}from"./ellipsis-vertical-BydhfEHx.js";import"./index-Ey8vtPr0.js";const ce=({addMember:l})=>{const[s,a]=t.useState(!1),[r,d]=t.useState(),[h,f]=t.useState(!1),w=z("(min-width: 768px)"),n=()=>{const b=new Uint32Array(1);crypto.getRandomValues(b);let y=Math.floor(1e5+b[0]/4294967296*9e5);d(I=>({...I,accessCode:String(y)}))},i=x=>{const{name:g,value:b}=x.target;d(y=>({...y,[g]:b}))},M=async x=>{if(x.preventDefault(),!(r!=null&&r.firstName)||!(r!=null&&r.lastName)||!(r!=null&&r.accessCode)){p.error("Veuillez renseigner tous les champs.");return}f(!0);try{await l(r),a(!1)}catch(g){console.log(g),p.error("Une erreur est survenue, veuillez contacter le support.")}f(!1)};return t.useEffect(()=>{s||d()},[s]),w?e.jsxs(J,{open:s,onOpenChange:a,children:[e.jsx($,{asChild:!0,children:e.jsx(c,{variant:"link",className:"py-0",children:"Ajouter un membre"})}),e.jsxs(G,{className:"sm:max-w-[425px]",children:[e.jsxs(V,{children:[e.jsx(U,{children:"Ajouter un membre"}),e.jsx(_,{children:"Entrez les informations du nouveau membre."})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"name",children:"Prénom"}),e.jsx(N,{name:"firstName",type:"text",placeholder:"Jean",onChange:i})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"name",children:"Nom"}),e.jsx(N,{name:"lastName",type:"text",placeholder:"Dupont",onChange:i})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"name",children:"Code d'accès"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(A,{maxLength:6,value:(r==null?void 0:r.accessCode)||null,onChange:x=>d({...r,accessCode:x}),children:e.jsxs(L,{children:[e.jsx(o,{index:0}),e.jsx(o,{index:1}),e.jsx(o,{index:2}),e.jsx(o,{index:3}),e.jsx(o,{index:4}),e.jsx(o,{index:5})]})}),e.jsx(c,{variant:"ghost",onClick:n,children:"Générer"})]})]})]}),e.jsx(q,{className:"sm:justify-start",children:e.jsx(Q,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(c,{variant:"outline",onClick:()=>d(),children:"Annuler"}),e.jsx(c,{onClick:M,disabled:h&&!0,children:h?e.jsx(R,{className:"animate-spin"}):"Ajouter"})]})})})]})]}):e.jsxs(K,{open:s,onOpenChange:a,children:[e.jsx(W,{asChild:!0,children:e.jsx(c,{variant:"link",className:"py-0",children:"Ajouter un membre"})}),e.jsxs(X,{children:[e.jsxs(Y,{children:[e.jsx(Z,{children:"Ajouter un membre"}),e.jsx(ee,{children:"Entrez les informations du nouveau membre."})]}),e.jsxs("div",{className:"flex flex-col px-4 gap-2",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"name",children:"Prénom"}),e.jsx(N,{name:"firstName",type:"text",placeholder:"Jean",onChange:i})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"name",children:"Nom"}),e.jsx(N,{name:"lastName",type:"text",placeholder:"Dupont",onChange:i})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"name",children:"Code d'accès"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(A,{maxLength:6,value:(r==null?void 0:r.accessCode)||null,onChange:x=>d({...r,accessCode:x}),children:e.jsxs(L,{children:[e.jsx(o,{index:0}),e.jsx(o,{index:1}),e.jsx(o,{index:2}),e.jsx(o,{index:3}),e.jsx(o,{index:4}),e.jsx(o,{index:5})]})}),e.jsx(c,{variant:"ghost",onClick:n,children:"Générer"})]})]})]}),e.jsx(se,{className:"pt-2",children:e.jsx(ae,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"w-full",onClick:M,disabled:h&&!0,children:h?e.jsx(R,{className:"animate-spin"}):"Ajouter"}),e.jsx(c,{className:"w-full",variant:"outline",onClick:()=>d(),children:"Annuler"})]})})})]})]})},de=ce,B=t.forwardRef(({className:l,...s},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:m("w-full caption-bottom text-sm",l),...s})}));B.displayName="Table";const F=t.forwardRef(({className:l,...s},a)=>e.jsx("thead",{ref:a,className:m("[&_tr]:border-b",l),...s}));F.displayName="TableHeader";const E=t.forwardRef(({className:l,...s},a)=>e.jsx("tbody",{ref:a,className:m("[&_tr:last-child]:border-0",l),...s}));E.displayName="TableBody";const xe=t.forwardRef(({className:l,...s},a)=>e.jsx("tfoot",{ref:a,className:m("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",l),...s}));xe.displayName="TableFooter";const k=t.forwardRef(({className:l,...s},a)=>e.jsx("tr",{ref:a,className:m("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",l),...s}));k.displayName="TableRow";const C=t.forwardRef(({className:l,...s},a)=>e.jsx("th",{ref:a,className:m("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",l),...s}));C.displayName="TableHead";const v=t.forwardRef(({className:l,...s},a)=>e.jsx("td",{ref:a,className:m("p-4 align-middle [&:has([role=checkbox])]:pr-0",l),...s}));v.displayName="TableCell";const me=t.forwardRef(({className:l,...s},a)=>e.jsx("caption",{ref:a,className:m("mt-4 text-sm text-muted-foreground",l),...s}));me.displayName="TableCaption";function Ce(){const[l,s]=t.useState([]),[a,r]=t.useState(!0),d=H(),h=O();t.useEffect(()=>{f()},[]);async function f(){var n;try{const{data:i}=await P.get("/api/salon/members");s(i)}catch(i){console.log(i),((n=i.response)==null?void 0:n.status)===401?d("/login",{state:{from:h},replace:!0}):p.error(i.message)}finally{r(!1)}}async function w(n){try{await P.post("/api/salon",n),f(),p.success("Membre ajouté avec succès.")}catch(i){p.error(i.message)}}return e.jsxs("main",{className:"w-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col gap-4",children:[e.jsx(re,{children:e.jsxs(le,{children:[e.jsx(T,{children:e.jsx(D,{asChild:!0,children:e.jsx(j,{to:"/",children:"Tableau de bord"})})}),e.jsx(S,{}),e.jsx(T,{children:e.jsx(D,{asChild:!0,children:e.jsx(j,{to:"/salon",children:"Salon"})})}),e.jsx(S,{}),e.jsx(T,{children:e.jsx(D,{asChild:!0,children:e.jsx(j,{to:"/salon/members",children:"Membres"})})})]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold",children:"Mon équipe"}),e.jsx(de,{addMember:w})]}),e.jsxs(B,{children:[e.jsx(F,{children:e.jsxs(k,{children:[e.jsx(C,{className:"w-[100px]",children:"Nom"}),e.jsx(C,{children:"Code d'accès"}),e.jsx(C,{className:"w-[100px]"})]})}),e.jsx(E,{children:l.map(n=>e.jsxs(k,{children:[e.jsxs(v,{className:"font-medium",children:[n.firstName," ",n.lastName]}),e.jsx(v,{children:n.accessCode}),e.jsx(v,{className:"text-right",children:e.jsxs(ne,{children:[e.jsx(te,{asChild:!0,children:e.jsx(c,{variant:"ghost",className:"ml-4",children:e.jsx(oe,{})})}),e.jsxs(ie,{align:"end",className:"w-fit flex flex-col gap-2",children:[e.jsx(j,{to:`/salon/members/${n.id}/informations`,asChild:!0,children:e.jsx(c,{className:"w-full",variant:"outline",children:"Informations"})}),e.jsx(j,{to:`/salon/members/${n.id}/availabilities`,asChild:!0,children:e.jsx(c,{className:"w-full",variant:"outline",children:"Disponibilités"})}),e.jsx(j,{to:`/salon/members/${n.id}/services`,asChild:!0,children:e.jsx(c,{className:"w-full",variant:"outline",children:"Prestations"})})]})]})})]},n.id))})]})]})}export{Ce as default};
