import{c as ce,r as o,j as e,B as l,w as b,I as A,x as w,J as j,a as v,C as oe,M as de,e as me,f as ue,v as xe,u as pe,g as he,h as je,i as k,k as M,L as y,m as _,N as Q}from"./index-B_B8nJ32.js";import{M as fe}from"./ModalAction-C8femSTp.js";import{u as I,D as R,a as L,b as T,c as O,d as z,j as D,k as P,l as E,e as F,f as $,g as B,h as V,i as U,m as X,n as H,o as J}from"./drawer-CWrfNPQk.js";import{A as ve,a as ge,b as Ne,c as we}from"./accordion-CkPCuVth.js";import{S as Y,a as Z,P as ye,C as ee,I as se,b as ae,c as te,R as re,L as ie,d as ne}from"./index-vkw7Q63K.js";import{P as q,a as G,b as K}from"./popover-nsTLZNYI.js";import{E as W}from"./ellipsis-vertical-CmpSXyq_.js";import"./Combination-DypWYJ4v.js";import"./index-COHgJa_G.js";/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=ce("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),be=({createCategory:a})=>{const[t,r]=o.useState(!1),[i,c]=o.useState(),[x,h]=o.useState(!1),[u,m]=o.useState(),f=I("(min-width: 768px)"),p=N=>{const{name:C,value:S}=N.target;c({[C]:S})},g=async N=>{if(N.preventDefault(),!(i!=null&&i.name)){m("Veuillez renseigner le nom de la catégorie.");return}h(!0);try{await a(i),r(!1)}catch{m("Une erreur est survenue, veuillez contacter le support.")}h(!1)};return o.useEffect(()=>{t||c()},[t]),f?e.jsxs(R,{open:t,onOpenChange:r,children:[e.jsx(L,{asChild:!0,children:e.jsx(l,{variant:"link",className:"py-0",children:"Ajouter une catégorie"})}),e.jsxs(T,{className:"sm:max-w-[425px]",children:[e.jsxs(O,{children:[e.jsx(z,{children:"Ajouter une catégorie"}),e.jsx(D,{children:"Définissez un nom pour ajouter une catégorie."})]}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{children:[e.jsx(b,{htmlFor:"name",children:"Nom"}),e.jsx(A,{id:"name",name:"name",type:"text",onChange:p})]})}),u&&setTimeout(()=>m(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:u}),e.jsx(P,{className:"sm:justify-start",children:e.jsx(E,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(l,{variant:"outline",onClick:()=>c(),children:"Annuler"}),e.jsx(l,{onClick:g,disabled:x&&!0,children:x?e.jsx(w,{className:"animate-spin"}):"Ajouter"})]})})})]})]}):e.jsxs(F,{open:t,onOpenChange:r,children:[e.jsx($,{asChild:!0,children:e.jsx(l,{variant:"link",className:"py-0",children:"Ajouter une catégorie"})}),e.jsxs(B,{children:[e.jsxs(V,{children:[e.jsx(U,{children:"Ajouter une categorie"}),e.jsx(X,{children:"Définissez un nom pour ajouter une categorie."})]}),e.jsx("div",{className:"flex flex-col px-4 gap-2",children:e.jsxs("div",{children:[e.jsx(b,{htmlFor:"name",children:"Nom"}),e.jsx(A,{id:"name",name:"name",type:"text",onChange:p})]})}),e.jsxs(H,{className:"pt-2",children:[u&&setTimeout(()=>m(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:u}),e.jsx(J,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"w-full",onClick:g,disabled:x&&!0,children:x?e.jsx(w,{className:"animate-spin"}):"Ajouter"}),e.jsx(l,{className:"w-full",variant:"outline",onClick:()=>c(),children:"Annuler"})]})})]})]})]})},Ae=({id:a,providerCategoryId:t,disableService:r})=>{const[i,c]=o.useState(!1),[x,h]=o.useState(!1),[u,m]=o.useState(),f=I("(min-width: 768px)"),p=async g=>{g.preventDefault(),h(!0);try{await r(a,t),c(!1)}catch{m("Une erreur est survenue, veuillez contacter le support.")}h(!1)};return f?e.jsxs(R,{open:i,onOpenChange:c,children:[e.jsx(L,{asChild:!0,children:e.jsx(l,{variant:"destructive",children:"Retirer la prestation"})}),e.jsxs(T,{className:"sm:max-w-[425px]",children:[e.jsxs(O,{children:[e.jsx(z,{className:"text-destructive",children:"Retirer la prestation"}),e.jsx(D,{children:"Êtes-vous sûr de vouloir retirer cette prestation ?"})]}),u&&setTimeout(()=>m(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:u}),e.jsx(P,{className:"sm:justify-start",children:e.jsx(E,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(l,{variant:"outline",children:"Annuler"}),e.jsx(l,{onClick:p,variant:"destructive",disabled:x&&!0,children:x?e.jsx(w,{className:"animate-spin"}):"Retirer"})]})})})]})]}):e.jsxs(F,{open:i,onOpenChange:c,children:[e.jsx($,{asChild:!0,children:e.jsx(l,{variant:"destructive",children:"Retirer la prestation"})}),e.jsxs(B,{children:[e.jsxs(V,{children:[e.jsx(U,{className:"text-destructive",children:"Retirer la prestation"}),e.jsx(X,{children:"Êtes-vous sûr de vouloir retirer cette prestation ?"})]}),e.jsxs(H,{className:"pt-2",children:[u&&setTimeout(()=>m(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:u}),e.jsx(J,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"w-full",onClick:p,variant:"destructive",disabled:x&&!0,children:x?e.jsx(w,{className:"animate-spin"}):"Retirer"}),e.jsx(l,{className:"w-full",variant:"outline",children:"Annuler"})]})})]})]})]})},De=({category:a,updateCategory:t})=>{const[r,i]=o.useState(!1),[c,x]=o.useState(),[h,u]=o.useState(!1),m=I("(min-width: 768px)"),f=async p=>{if(p.preventDefault(),u(!0),!(c!==a.name)){u(!1),i(!1),j("Aucun changement n'a été effectué.");return}try{await t(a.id,{name:c}),i(!1)}catch{j.error("Une erreur est survenue, veuillez contacter le support.")}u(!1)};return m?e.jsxs(R,{open:r,onOpenChange:i,children:[e.jsx(L,{asChild:!0,children:e.jsx(l,{variant:"outline",children:"Modifier la catégorie"})}),e.jsxs(T,{className:"sm:max-w-[425px]",children:[e.jsx(O,{children:e.jsx(z,{children:"Modifier le nom de la catégorie"})}),e.jsxs(D,{children:[e.jsx(b,{htmlFor:"name",children:"Nom"}),e.jsx(A,{id:"name",name:"name",type:"text",defaultValue:a.name,onChange:p=>x(p.target.value)})]}),e.jsx(P,{className:"sm:justify-start",children:e.jsx(E,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(l,{onClick:f,disabled:h&&!0,children:h?e.jsx(w,{className:"animate-spin"}):"Modifier"}),e.jsx(l,{variant:"outline",onClick:()=>setCategory(),children:"Annuler"})]})})})]})]}):e.jsxs(F,{open:r,onOpenChange:i,children:[e.jsx($,{asChild:!0,children:e.jsx(l,{variant:"outline",children:"Modifier la catégorie"})}),e.jsxs(B,{children:[e.jsx(V,{children:e.jsx(U,{children:" Modifier le nom de la catégorie"})}),e.jsx(D,{children:e.jsxs("div",{className:"px-4",children:[e.jsx(b,{htmlFor:"name",children:"Nom"}),e.jsx(A,{id:"name",name:"name",type:"text",defaultValue:a.name,onChange:p=>x(p.target.value)})]})}),e.jsx(H,{className:"pt-2",children:e.jsx(J,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"w-full",onClick:f,disabled:h&&!0,children:h?e.jsx(w,{className:"animate-spin"}):"Modifier"}),e.jsx(l,{className:"w-full",variant:"outline",onClick:()=>setCategory(),children:"Annuler"})]})})})]})]})},Se=o.forwardRef(({className:a,inset:t,children:r,...i},c)=>e.jsxs(Y,{ref:c,className:v("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",a),...i,children:[r,e.jsx(oe,{className:"ml-auto h-4 w-4"})]}));Se.displayName=Y.displayName;const ke=o.forwardRef(({className:a,...t},r)=>e.jsx(Z,{ref:r,className:v("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...t}));ke.displayName=Z.displayName;const Me=o.forwardRef(({className:a,sideOffset:t=4,...r},i)=>e.jsx(ye,{children:e.jsx(ee,{ref:i,sideOffset:t,className:v("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})}));Me.displayName=ee.displayName;const Ie=o.forwardRef(({className:a,inset:t,...r},i)=>e.jsx(se,{ref:i,className:v("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",a),...r}));Ie.displayName=se.displayName;const Re=o.forwardRef(({className:a,children:t,checked:r,...i},c)=>e.jsxs(ae,{ref:c,className:v("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:r,...i,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(te,{children:e.jsx(de,{className:"h-4 w-4"})})}),t]}));Re.displayName=ae.displayName;const Le=o.forwardRef(({className:a,children:t,...r},i)=>e.jsxs(re,{ref:i,className:v("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(te,{children:e.jsx(Ce,{className:"h-2 w-2 fill-current"})})}),t]}));Le.displayName=re.displayName;const Te=o.forwardRef(({className:a,inset:t,...r},i)=>e.jsx(ie,{ref:i,className:v("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",a),...r}));Te.displayName=ie.displayName;const le=o.forwardRef(({className:a,...t},r)=>e.jsx(ne,{ref:r,className:v("-mx-1 my-1 h-px bg-muted",a),...t}));le.displayName=ne.displayName;const Oe={ON_SITE:"Sur place",DEPOSIT:"Acompte",FULL:"Complet"},Je=()=>{const[a,t]=o.useState(),[r,i]=o.useState(!0),c=me(),x=ue(),h=xe(),{auth:u}=pe();o.useEffect(()=>{m()},[]);async function m(){var s;try{const d=await c.get("/api/providerCategory/me");t(d.data)}catch(d){((s=d.response)==null?void 0:s.status)===401?x("/login",{state:{from:h},replace:!0}):j.error(d.message)}i(!1)}async function f(s){try{await c.post("/api/providerCategory",s),m()}catch(d){j.error(d.message)}}async function p(s){try{await c.put(`/api/providerService/${s}`,{isActive:!0}),m()}catch(d){j.error(d.message)}}async function g(s){try{await c.put(`/api/providerCategory/${s}`,{isActive:!0}),m()}catch(d){j.error(d.message)}}async function N(s,d){try{await c.put(`/api/providerCategory/${s}`,d),m(),j.success("Catégorie mise à jour")}catch(n){j.error(n.message)}}async function C(s,d){try{await c.put(`/api/providerService/${s}`,{isActive:!1,providerCategoryId:d}),m()}catch(n){j.error(n.message)}}async function S(s){try{await c.put(`/api/providerCategory/${s}`,{isActive:!1}),m()}catch(d){j.error(d.message)}}return r?e.jsx(w,{className:"w-8 h-8 animate-spin flex-1"}):e.jsxs("main",{className:"w-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col space-y-4",children:[e.jsx(he,{children:e.jsxs(je,{children:[e.jsx(k,{children:e.jsx(M,{asChild:!0,children:e.jsx(y,{to:"/",children:"Tableau de bord"})})}),e.jsx(_,{}),e.jsx(k,{children:e.jsx(M,{asChild:!0,children:e.jsx(y,{to:"/salon",children:"Salon"})})}),e.jsx(_,{}),e.jsx(k,{children:e.jsx(M,{asChild:!0,children:e.jsx(y,{to:"/salon/services",children:"Prestations"})})})]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold",children:"Mes prestations"}),e.jsx(be,{createCategory:f})]}),a==null?void 0:a.map((s,d)=>s.isActive&&e.jsx(ve,{type:"single",collapsible:!0,defaultValue:"item-0",children:e.jsxs(ge,{value:`item-${d}`,className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ne,{children:e.jsx("h2",{className:"text-2xl font-medium text-left",children:s.name})}),e.jsx("div",{className:"space-x-2",children:e.jsxs(q,{children:[e.jsx(G,{asChild:!0,children:e.jsx(l,{variant:"ghost",className:"ml-4",children:e.jsx(W,{})})}),e.jsxs(K,{align:"end",className:"w-fit flex flex-col gap-2",children:[e.jsx(l,{variant:"outline",children:e.jsx(y,{to:`/salon/services/create-service?providerCategoryId=${s.id}`,children:"Ajouter une prestation"})}),e.jsx(le,{}),e.jsx(De,{category:s,updateCategory:N}),e.jsx(fe,{id:s.id,action:S,actionLabel:"Retirer",variant:"destructive",title:"Retirer la catégorie",description:"Toutes les prestations associées seront retirées.",trigger:"Retirer la catégorie",triggerVariant:"destructive"})]})]})})]}),e.jsx("ul",{className:"space-y-2",children:s.services.map(n=>n.isActive&&e.jsx(we,{children:e.jsxs("li",{className:"space-y-2 w-full rounded-md p-4 pt-2 pr-0 bg-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl",children:n.name}),e.jsxs(q,{children:[e.jsx(G,{asChild:!0,children:e.jsx(l,{variant:"ghost",className:"ml-4",children:e.jsx(W,{})})}),e.jsxs(K,{align:"end",className:"w-fit flex flex-col gap-2",children:[e.jsx(l,{variant:"outline",children:e.jsx(y,{to:`/salon/services/${n.id}`,children:"Modifier la prestation"})}),e.jsx(Ae,{id:n.id,providerCategoryId:s.id,disableService:C})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"pr-4 line-clamp-2 text-muted whitespace-pre-line",children:n.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center justify-between pr-4",children:[e.jsxs("div",{className:"flex gap-2 bg-primary text-white w-fit px-2 py-1 rounded",children:[e.jsxs("p",{children:[n.price,"€"]}),"•",e.jsx("p",{children:Q(n.duration)})]}),e.jsxs("div",{className:"flex gap-2 bg-primary text-white w-fit px-2 py-1 rounded",children:[e.jsx("p",{children:Oe[n.paymentOption||u.defaultPaymentOption]}),n.paymentOption==="DEPOSIT"&&e.jsxs(e.Fragment,{children:["•",e.jsxs("p",{children:[n.deposit,"€"]})]})]})]})]})]})},n.id))})]})},s.id)),e.jsx("div",{className:"divider divider-start text-muted",children:"Inactives"}),a.map(s=>(s.services.some(n=>!n.isActive)||!s.isActive)&&e.jsxs("div",{className:"space-y-2 text-muted",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-medium",children:s.name}),!s.isActive&&e.jsx(l,{variant:"link",onClick:()=>g(s.id),children:"Activer la catégorie"})]}),e.jsx("ul",{className:"space-y-2",children:s.services.map(n=>(!n.isActive||!s.isActive)&&e.jsx("li",{className:"flex items-center justify-between gap-4",children:e.jsxs("div",{className:"w-full rounded-md p-4 bg-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{children:n.name}),s.isActive&&!n.isActive&&e.jsx(l,{variant:"link",onClick:()=>p(n.id),children:"Activer le service"}),!s.isActive&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("p",{children:Q(n.duration)}),e.jsx("div",{className:"divider divider-horizontal"}),e.jsxs("p",{children:[n.price,"€"]})]})]}),e.jsx("p",{className:"whitespace-pre-line",children:n.description})]})},n.id))})]},s.id)),e.jsxs("p",{className:"text-sm text-muted",children:["La suppression des catégories et services est restreinte afin d'améliorer l'analyse de l'activité. ",e.jsx("br",{})," Pour supprimer définitivement une catégorie ou un service, veuillez"," ",e.jsxs(l,{variant:"link",className:"pl-0",children:[e.jsx("a",{href:"https://www.weconnect-rdv.fr/provider/cm13ksbde0000g98rx8rpbwte",target:"_blank",rel:"noreferrer noopener",children:"contacter le support"}),"."]})]})]})};export{Je as default};
