import{r as t,j as e,B as o,I as v,v as A,w as L,x as i,p as P,J as p,a as m,e as I,m as H,L as j}from"./index-DcugkPC_.js";import{u as O,D as z,a as J,b as $,c as G,d as V,j as U,k as _,l as q,e as Q,f as K,g as W,h as X,i as Y,m as Z,n as ee,o as se}from"./drawer-BN1iXKWN.js";import{L as u}from"./label-BEDWncpw.js";import{B as ae,a as re,b as D,c as k,d as R}from"./breadcrumb-B8aUs7HV.js";import{P as le,a as ne,b as te}from"./popover-WLexqxPa.js";import{u as ie}from"./useAxiosPrivate-BQKv4A0e.js";import{E as oe}from"./ellipsis-vertical-rKOkNdea.js";import"./axiosPrivate-DKatnhxZ.js";const ce=({addMember:l})=>{const[s,a]=t.useState(!1),[r,d]=t.useState(),[h,f]=t.useState(!1),g=O("(min-width: 768px)"),b=()=>{const C=new Uint32Array(1);crypto.getRandomValues(C);let T=Math.floor(1e5+C[0]/4294967296*9e5);d(E=>({...E,accessCode:String(T)}))},n=x=>{const{name:N,value:C}=x.target;d(T=>({...T,[N]:C}))},c=async x=>{if(x.preventDefault(),!(r!=null&&r.firstName)||!(r!=null&&r.lastName)||!(r!=null&&r.accessCode)){p.error("Veuillez renseigner tous les champs.");return}f(!0);try{await l(r),a(!1)}catch(N){console.log(N),p.error("Une erreur est survenue, veuillez contacter le support.")}f(!1)};return t.useEffect(()=>{s||d()},[s]),g?e.jsxs(z,{open:s,onOpenChange:a,children:[e.jsx(J,{asChild:!0,children:e.jsx(o,{variant:"link",className:"py-0",children:"Ajouter un membre"})}),e.jsxs($,{className:"sm:max-w-[425px]",children:[e.jsxs(G,{children:[e.jsx(V,{children:"Ajouter un membre"}),e.jsx(U,{children:"Entrez les informations du nouveau membre."})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"name",children:"Prénom"}),e.jsx(v,{name:"firstName",type:"text",placeholder:"Jean",onChange:n})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"name",children:"Nom"}),e.jsx(v,{name:"lastName",type:"text",placeholder:"Dupont",onChange:n})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"name",children:"Code d'accès"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(A,{maxLength:6,value:(r==null?void 0:r.accessCode)||null,onChange:x=>d({...r,accessCode:x}),children:e.jsxs(L,{children:[e.jsx(i,{index:0}),e.jsx(i,{index:1}),e.jsx(i,{index:2}),e.jsx(i,{index:3}),e.jsx(i,{index:4}),e.jsx(i,{index:5})]})}),e.jsx(o,{variant:"ghost",onClick:b,children:"Générer"})]})]})]}),e.jsx(_,{className:"sm:justify-start",children:e.jsx(q,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(o,{variant:"outline",onClick:()=>d(),children:"Annuler"}),e.jsx(o,{onClick:c,disabled:h&&!0,children:h?e.jsx(P,{className:"animate-spin"}):"Ajouter"})]})})})]})]}):e.jsxs(Q,{open:s,onOpenChange:a,children:[e.jsx(K,{asChild:!0,children:e.jsx(o,{variant:"link",className:"py-0",children:"Ajouter un membre"})}),e.jsxs(W,{children:[e.jsxs(X,{children:[e.jsx(Y,{children:"Ajouter un membre"}),e.jsx(Z,{children:"Entrez les informations du nouveau membre."})]}),e.jsxs("div",{className:"flex flex-col px-4 gap-2",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"name",children:"Prénom"}),e.jsx(v,{name:"firstName",type:"text",placeholder:"Jean",onChange:n})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"name",children:"Nom"}),e.jsx(v,{name:"lastName",type:"text",placeholder:"Dupont",onChange:n})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"name",children:"Code d'accès"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(A,{maxLength:6,value:(r==null?void 0:r.accessCode)||null,onChange:x=>d({...r,accessCode:x}),children:e.jsxs(L,{children:[e.jsx(i,{index:0}),e.jsx(i,{index:1}),e.jsx(i,{index:2}),e.jsx(i,{index:3}),e.jsx(i,{index:4}),e.jsx(i,{index:5})]})}),e.jsx(o,{variant:"ghost",onClick:b,children:"Générer"})]})]})]}),e.jsx(ee,{className:"pt-2",children:e.jsx(se,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{className:"w-full",onClick:c,disabled:h&&!0,children:h?e.jsx(P,{className:"animate-spin"}):"Ajouter"}),e.jsx(o,{className:"w-full",variant:"outline",onClick:()=>d(),children:"Annuler"})]})})})]})]})},de=ce,S=t.forwardRef(({className:l,...s},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:m("w-full caption-bottom text-sm",l),...s})}));S.displayName="Table";const B=t.forwardRef(({className:l,...s},a)=>e.jsx("thead",{ref:a,className:m("[&_tr]:border-b",l),...s}));B.displayName="TableHeader";const F=t.forwardRef(({className:l,...s},a)=>e.jsx("tbody",{ref:a,className:m("[&_tr:last-child]:border-0",l),...s}));F.displayName="TableBody";const xe=t.forwardRef(({className:l,...s},a)=>e.jsx("tfoot",{ref:a,className:m("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",l),...s}));xe.displayName="TableFooter";const M=t.forwardRef(({className:l,...s},a)=>e.jsx("tr",{ref:a,className:m("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",l),...s}));M.displayName="TableRow";const w=t.forwardRef(({className:l,...s},a)=>e.jsx("th",{ref:a,className:m("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",l),...s}));w.displayName="TableHead";const y=t.forwardRef(({className:l,...s},a)=>e.jsx("td",{ref:a,className:m("p-4 align-middle [&:has([role=checkbox])]:pr-0",l),...s}));y.displayName="TableCell";const me=t.forwardRef(({className:l,...s},a)=>e.jsx("caption",{ref:a,className:m("mt-4 text-sm text-muted-foreground",l),...s}));me.displayName="TableCaption";function Ce(){const[l,s]=t.useState([]),[a,r]=t.useState(!0),d=I(),h=H(),f=ie();t.useEffect(()=>{g()},[]);async function g(){var n;try{const{data:c}=await f.get("/api/salon/members");s(c)}catch(c){console.log(c),((n=c.response)==null?void 0:n.status)===401?d("/login",{state:{from:h},replace:!0}):p.error(c.message)}finally{r(!1)}}async function b(n){try{await f.post("/api/salon",n),g(),p.success("Membre ajouté avec succès.")}catch(c){p.error(c.message)}}return e.jsxs("main",{className:"w-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col gap-4",children:[e.jsx(ae,{children:e.jsxs(re,{children:[e.jsx(D,{children:e.jsx(k,{asChild:!0,children:e.jsx(j,{to:"/",children:"Tableau de bord"})})}),e.jsx(R,{}),e.jsx(D,{children:e.jsx(k,{asChild:!0,children:e.jsx(j,{to:"/salon",children:"Salon"})})}),e.jsx(R,{}),e.jsx(D,{children:e.jsx(k,{asChild:!0,children:e.jsx(j,{to:"/salon/members",children:"Membres"})})})]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold",children:"Mon équipe"}),e.jsx(de,{addMember:b})]}),e.jsxs(S,{children:[e.jsx(B,{children:e.jsxs(M,{children:[e.jsx(w,{className:"w-[100px]",children:"Nom"}),e.jsx(w,{children:"Code d'accès"}),e.jsx(w,{className:"w-[100px]"})]})}),e.jsx(F,{children:l.map(n=>e.jsxs(M,{children:[e.jsxs(y,{className:"font-medium",children:[n.firstName," ",n.lastName]}),e.jsx(y,{children:n.accessCode}),e.jsx(y,{className:"text-right",children:e.jsxs(le,{children:[e.jsx(ne,{asChild:!0,children:e.jsx(o,{variant:"ghost",className:"ml-4",children:e.jsx(oe,{})})}),e.jsxs(te,{align:"end",className:"w-fit flex flex-col gap-2",children:[e.jsx(j,{to:`/salon/members/${n.id}/informations`,asChild:!0,children:e.jsx(o,{className:"w-full",variant:"outline",children:"Informations"})}),e.jsx(j,{to:`/salon/members/${n.id}/availabilities`,asChild:!0,children:e.jsx(o,{className:"w-full",variant:"outline",children:"Disponibilités"})}),e.jsx(j,{to:`/salon/members/${n.id}/services`,asChild:!0,children:e.jsx(o,{className:"w-full",variant:"outline",children:"Prestations"})})]})]})})]},n.id))})]})]})}export{Ce as default};
