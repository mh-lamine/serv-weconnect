import{c as J,j as e,l as D,B as j,n as W,r as i,o as K,p as Q,P as F,q as Y,s as Z,t as ee,a as _,u as se,e as te,f as ae,v as re,g as ne,h as oe,i as B,k as M,L as A,m as z,w as x,I as C,T as ce,x as ie,J as f}from"./index-BWvnkDLc.js";import{A as le,a as de,b as ue}from"./avatar-ByWIfQJu.js";import{P as he,a as me,b as pe}from"./popover-ubhfu1_D.js";import"./Combination-DqpJqWpQ.js";/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=J("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),fe=()=>e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-2",children:[e.jsx("h1",{className:"text-3xl text-destructive",children:"Oops!"}),e.jsx("p",{children:"Une erreur s'est produite."})]}),ve=fe;function ge({name:t,address:l,profilePicture:n,coverImage:s,rmprofile:o,rmcover:d}){const c=async u=>{try{u==="profile"&&await o(),u==="cover"&&await d()}catch(p){console.error(p)}};return e.jsxs("div",{className:"hero w-full aspect-video relative max-h-[40vh] sm:max-h-[20vh] rounded-md overflow-hidden",style:{backgroundImage:`url("${s&&s}")`,backgroundSize:"cover",backgroundPosition:"center"},children:[e.jsx("div",{className:"hero-overlay bg-opacity-40"}),e.jsx("div",{className:"hero-content text-neutral-content mt-auto mr-auto",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(le,{className:"w-16 h-16",children:[e.jsx(de,{src:n}),e.jsx(ue,{className:"text-2xl",children:t&&D(t)})]}),e.jsxs("div",{className:"ml-4 space-y-1",children:[e.jsx("h1",{className:"text-2xl font-semibold bg-muted px-2 py-1 rounded-sm w-fit",children:t}),e.jsx("p",{className:"bg-muted px-2 py-1 rounded-sm w-fit",children:l})]})]})}),e.jsx("div",{className:"absolute top-3 right-3",children:e.jsxs(he,{children:[e.jsx(me,{asChild:!0,children:e.jsx(j,{variant:"destructive",children:e.jsx(xe,{})})}),e.jsxs(pe,{align:"end",className:"w-fit flex flex-col gap-2",children:[e.jsx(j,{variant:"outline",onClick:()=>c("profile"),children:"Supprimer la photo de profil"}),e.jsx(j,{variant:"outline",onClick:()=>c("cover"),children:"Supprimer la photo de couverture"})]})]})})]})}var R="Switch",[je,Be]=W(R),[be,ye]=je(R),H=i.forwardRef((t,l)=>{const{__scopeSwitch:n,name:s,checked:o,defaultChecked:d,required:c,disabled:u,value:p="on",onCheckedChange:m,...b}=t,[h,k]=i.useState(null),I=K(l,N=>k(N)),S=i.useRef(!1),T=h?!!h.closest("form"):!0,[y=!1,g]=Q({prop:o,defaultProp:d,onChange:m});return e.jsxs(be,{scope:n,checked:y,disabled:u,children:[e.jsx(F.button,{type:"button",role:"switch","aria-checked":y,"aria-required":c,"data-state":q(y),"data-disabled":u?"":void 0,disabled:u,value:p,...b,ref:I,onClick:Y(t.onClick,N=>{g(E=>!E),T&&(S.current=N.isPropagationStopped(),S.current||N.stopPropagation())})}),T&&e.jsx(Ne,{control:h,bubbles:!S.current,name:s,value:p,checked:y,required:c,disabled:u,style:{transform:"translateX(-100%)"}})]})});H.displayName=R;var O="SwitchThumb",$=i.forwardRef((t,l)=>{const{__scopeSwitch:n,...s}=t,o=ye(O,n);return e.jsx(F.span,{"data-state":q(o.checked),"data-disabled":o.disabled?"":void 0,...s,ref:l})});$.displayName=O;var Ne=t=>{const{control:l,checked:n,bubbles:s=!0,...o}=t,d=i.useRef(null),c=Z(n),u=ee(l);return i.useEffect(()=>{const p=d.current,m=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(m,"checked").set;if(c!==n&&h){const k=new Event("click",{bubbles:s});h.call(p,n),p.dispatchEvent(k)}},[c,n,s]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...o,tabIndex:-1,ref:d,style:{...t.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function q(t){return t?"checked":"unchecked"}var V=H,we=$;const L=i.forwardRef(({className:t,...l},n)=>e.jsx(V,{className:_("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...l,ref:n,children:e.jsx(we,{className:_("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));L.displayName=V.displayName;const Ce=/^(?:(?:\+|00)33\s?[1-9](?:[\s.-]?\d{2}){4}|0[1-9](?:[\s.-]?\d{2}){4})$/,ke=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i,Se=["image/jpeg","image/jpg","image/png"];function Me(){const{auth:t}=se(),[l,n]=i.useState(),[s,o]=i.useState(),[d,c]=i.useState(),[u,p]=i.useState(),[m,b]=i.useState({SPLASH_SCREEN:!0,SUBMIT_BUTTON:!1}),h=te(),k=ae(),I=re();async function S(){var r;try{const{data:a}=await h.get("/api/salon");return n(a),o(a),c({profilePicture:a.profilePicture,coverImage:a.coverImage}),a}catch(a){p(a),((r=a.response)==null?void 0:r.status)===401&&k("/login",{state:{from:I},replace:!0})}finally{b({...m,SPLASH_SCREEN:!1})}}const T=async()=>{try{await h.delete("/api/s3/profile",{profilePicture:null}),c({...d,profilePicture:null})}catch(r){console.log(r)}},y=async()=>{try{await h.delete("/api/s3/cover",{coverImage:null}),c({...d,coverImage:null})}catch(r){console.log(r)}},g=r=>{const{id:a,value:v}=r.target;o({...s,[a]:v})},N=async r=>{r.preventDefault();const{name:a,email:v,phoneNumber:w}=s;if(!a||!v||!w){f.error("Veuillez renseigner tous les champs obligatoires");return}if(!Object.keys(s).some(P=>s[P]!==l[P])){f("Aucune modification n'a été effectuée");return}if(v&&!ke.test(v)){f.error("L'adresse email n'est pas valide");return}if(w&&!Ce.test(w)){f.error("Le numéro de téléphone n'est pas valide");return}try{b({...m,SUBMIT_BUTTON:!0}),await h.patch("/api/salon",{...s}),f("Modifications enregistrées")}catch{f.error("Une erreur est survenue, veuillez contacter le support")}finally{b({...m,SUBMIT_BUTTON:!1})}},E=async r=>{const{id:a,files:v}=r.target;if(!Se.includes(v[0].type)){f.error("Le format du fichier n'est pas valide");return}const w=new FormData;w.append(a,v[0]);const U=a==="profile"?"profilePicture":"coverImage",P=a==="profile"?"profile-picture":"cover/cover-image",X=`https://wcntbucket.s3.eu-west-3.amazonaws.com/user-${t.id}/${P}`;try{await h.post(`/api/s3/${a}`,w,{headers:{"Content-Type":"multipart/form-data"}}),c({...d,[U]:`${X}?t=${new Date().getTime()}`}),f.success("Photo mise à jour avec succès")}catch(G){console.error(G.response.data.message),f.error("Une erreur est survenue, veuillez contacter le support")}};return i.useEffect(()=>{S()},[]),u?e.jsx(ve,{errMsg:u}):m.SPLASH_SCREEN?e.jsx("div",{children:"Loading..."}):e.jsxs("main",{className:"w-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col gap-4",children:[e.jsx(ne,{children:e.jsxs(oe,{children:[e.jsx(B,{children:e.jsx(M,{asChild:!0,children:e.jsx(A,{to:"/",children:"Tableau de bord"})})}),e.jsx(z,{}),e.jsx(B,{children:e.jsx(M,{asChild:!0,children:e.jsx(A,{to:"/salon",children:"Salon"})})}),e.jsx(z,{}),e.jsx(B,{children:e.jsx(M,{asChild:!0,children:e.jsx(A,{to:"/salon/informations",children:"Informations"})})})]})}),e.jsx("h1",{className:"text-3xl font-semibold",children:"Mes informations"}),e.jsx(ge,{name:s.name,address:s.address,profilePicture:d.profilePicture,coverImage:d.coverImage,rmprofile:T,rmcover:y}),e.jsxs("div",{className:"space-y-2 md:space-y-0 md:grid grid-cols-2 md:gap-4",children:[e.jsx(j,{asChild:!0,children:e.jsx(x,{htmlFor:"profile",className:"w-full",children:"Changer ma photo de profil"})}),e.jsx(C,{className:"hidden",type:"file",id:"profile",onChange:E}),e.jsx(j,{asChild:!0,children:e.jsx(x,{htmlFor:"cover",className:"w-full",children:"Changer ma photo de couverture"})}),e.jsx(C,{className:"hidden",type:"file",id:"cover",onChange:E})]}),e.jsxs("form",{className:"space-y-2",children:[e.jsxs("div",{className:"space-y-2 md:space-y-0 md:grid grid-cols-2 md:gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"name",children:"Nom du salon"}),e.jsx(C,{id:"name",type:"text",value:s==null?void 0:s.name,onChange:g,className:"text-lg"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"address",children:"Adresse"}),e.jsx(C,{id:"address",type:"text",value:s.address,onChange:g,className:"text-lg"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"phoneNumber",children:"Téléphone du salon"}),e.jsx(C,{id:"phoneNumber",type:"tel",value:s.phoneNumber,onChange:g,className:"text-lg"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"email",children:"Email"}),e.jsx(C,{id:"email",type:"email",value:s.email,onChange:g,className:"text-lg"})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"autoAccept",children:"Confirmation automatique"}),e.jsxs("div",{className:"bg-white rounded-md px-3 py-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("p",{children:"Choisissez ou non d'accepter automatiquement les demandes de rendez-vous."}),e.jsx(L,{id:"autoAccept",checked:s==null?void 0:s.autoAcceptAppointments,onCheckedChange:r=>{o({...s,autoAcceptAppointments:r})}})]}),e.jsxs("p",{className:"text-muted",children:["Si vous choisissez de ne pas accepter automatiquement les demandes de rendez-vous, elles auront le status ",e.jsx("b",{children:"En attente"})," tant que vous ne les aurez pas confirmées ou refusées."]})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"vacancyMode",className:"text-destructive",children:"Mode vacances"}),e.jsxs("div",{className:"bg-white rounded-md px-3 py-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("p",{children:"Passez en mode vacances pour ne plus recevoir de demandes de rendez-vous."}),e.jsx(L,{id:"vacancyMode",checked:s==null?void 0:s.isInVacancyMode,onCheckedChange:r=>{o({...s,isInVacancyMode:r})},className:"data-[state=checked]:bg-destructive"})]}),e.jsx("p",{className:"text-muted",children:"En cas de fermerture temporaire de votre salon, vous pouvez activer le mode vacances pour ne plus recevoir de demandes de rendez-vous pendant un certain temps."})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(x,{htmlFor:"terms",children:"Conditions de réservation"}),e.jsx(ce,{id:"bookingTerms",type:"text",defaultValue:s.bookingTerms,onChange:g,className:"text-lg whitespace-pre-line"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{onClick:N,disabled:m.SUBMIT_BUTTON,children:m.SUBMIT_BUTTON?e.jsx(ie,{className:"animate-spin"}):"Enregistrer les modifications"}),e.jsx(j,{variant:"outline",type:"button",onClick:()=>o(l),children:"Annuler"})]})]})]})}export{Me as default};
