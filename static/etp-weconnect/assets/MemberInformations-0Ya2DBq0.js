import{r,F as $,v as P,f as R,e as A,j as s,g as E,h as F,i as l,k as o,L as c,m as h,w as f,I as j,B as b,x as V,J as y}from"./index-B1QHrCHD.js";import{M as k}from"./ModalAction-CTJ2hjHs.js";import"./drawer-NP4VIGUB.js";import"./Combination-PVGnqS30.js";function O(){const[e,L]=r.useState(null),[n,g]=r.useState(null),[N,d]=r.useState(!1),{id:m}=$(),B=P(),p=R(),u=A();r.useEffect(()=>{C()},[]);async function C(){var a;try{const{data:t}=await u.get(`/api/salon/members/${m}`);L(t)}catch(t){console.error(t),((a=t.response)==null?void 0:a.status)===401&&p("/login",{state:{from:B},replace:!0})}}const x=a=>{const{id:t,value:i}=a.target;g(I=>({...I,[t]:i}))},S=async a=>{if(a.preventDefault(),!n)return;if(!Object.keys(n).some(i=>n[i]!==e[i])){d(!1),y("Aucune modification n'a été effectuée");return}try{d(!0),await u.patch(`/api/salon/members/${m}`,n),C(),y.success("Les informations du membre ont été mises à jour.")}catch(i){console.error(i)}finally{d(!1)}},w=async a=>{try{await u.delete(`/api/salon/members/${a}`),p("/salon/members")}catch(t){console.error(t)}};return s.jsxs("main",{className:"w-full h-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col gap-4",children:[s.jsx(E,{children:s.jsxs(F,{children:[s.jsx(l,{children:s.jsx(o,{asChild:!0,children:s.jsx(c,{to:"/",children:"Tableau de bord"})})}),s.jsx(h,{}),s.jsx(l,{children:s.jsx(o,{asChild:!0,children:s.jsx(c,{to:"/salon",children:"Salon"})})}),s.jsx(h,{}),s.jsx(l,{children:s.jsx(o,{asChild:!0,children:s.jsx(c,{to:"/salon/members",children:"Membres"})})}),s.jsx(h,{}),s.jsx(l,{children:s.jsx(o,{asChild:!0,children:s.jsxs(c,{to:`/salon/members/${m}/informations`,children:[e==null?void 0:e.firstName," ",e==null?void 0:e.lastName]})})})]})}),s.jsxs("h1",{className:"text-3xl font-semibold",children:[e==null?void 0:e.firstName," ",e==null?void 0:e.lastName]}),s.jsx("p",{className:"text-muted",children:"Gérez les informations du membre."}),s.jsxs("form",{className:"space-y-4",onSubmit:S,onReset:a=>{a.target.reset(),g(null)},children:[s.jsxs("div",{className:"space-y-2 md:space-y-0 md:grid grid-cols-2 md:gap-4",children:[s.jsxs("div",{children:[s.jsx(f,{htmlFor:"firstName",children:"Prénom"}),s.jsx(j,{id:"firstName",type:"text",name:"firstName",defaultValue:e==null?void 0:e.firstName,onChange:x,className:"text-lg"})]}),s.jsxs("div",{children:[s.jsx(f,{htmlFor:"lastName",children:"Nom"}),s.jsx(j,{id:"lastName",type:"text",name:"lastName",defaultValue:e==null?void 0:e.lastName,onChange:x,className:"text-lg"})]}),s.jsxs("div",{children:[s.jsx(f,{htmlFor:"accessCode",children:"Code d'accès"}),s.jsx(j,{id:"accessCode",type:"text",name:"accessCode",defaultValue:e==null?void 0:e.accessCode,onChange:x,disabled:!0,className:"text-lg"})]})]}),n&&s.jsxs("div",{className:"flex gap-2",children:[s.jsx(b,{type:"submit",disabled:N,children:N?s.jsx(V,{className:"animate-spin"}):"Enregistrer les modifications"}),s.jsx(b,{variant:"outline",type:"reset",children:"Annuler"})]})]}),s.jsx("div",{className:"mt-auto",children:s.jsx(k,{id:e==null?void 0:e.id,action:w,actionLabel:"Retirer le membre",variant:"destructive",title:"Retirer du salon",description:"Le membre sera retiré du salon et ne pourra plus accéder à l'application.",trigger:"Retirer le membre",triggerVariant:"destructive",successMessage:`${e==null?void 0:e.firstName} ${e==null?void 0:e.lastName} a été retiré du salon.`})})]})}export{O as default};
