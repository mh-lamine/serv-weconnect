import{r as l,u as B,e as E,j as e,I as y,B as c,x as N,a2 as k,a3 as T,a4 as q,a5 as F,a8 as M,a6 as o,J as U,g as J,h as R,i as d,k as m,L as p,m as v}from"./index-B1QHrCHD.js";import{L as g}from"./index-CETA2znm.js";import"./Combination-PVGnqS30.js";import"./index-BoQW1Puh.js";function H(){const[u,x]=l.useState(!1),[f,h]=l.useState(!1),{auth:s,setAuth:C}=B(),j=E(),[a,r]=l.useState({defaultDeposit:s==null?void 0:s.defaultDeposit,defaultPaymentOption:s==null?void 0:s.defaultPaymentOption}),[P,n]=l.useState(!1),D=async()=>{try{x(!0);const{data:t}=await j.post("/api/stripe/startOnboarding");window.open(t)}catch(t){console.error(t)}finally{x(!1)}},L=t=>{const{name:i,value:b,type:I}=t.target;r({...a,[i]:I==="number"?+b:b}),n(!0)},w=async t=>{t.preventDefault();try{h(!0),await j.patch("/api/salon",a),C({...s,...a}),U.success("Modifications enregistrées")}catch(i){console.error(i)}finally{h(!1),n(!1)}},O=async t=>{t.preventDefault(),r({defaultDeposit:s.defaultDeposit,defaultPaymentOption:s.defaultPaymentOption}),n(!1)},A=()=>Math.round(50*(a.defaultDeposit/100));return s.stripeConnectedAccountId?e.jsxs("main",{className:"w-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col gap-4",children:[e.jsx(S,{}),e.jsx("h1",{className:"text-3xl font-semibold",children:"Mes paiements"}),e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Paiement par défault"}),e.jsxs(k,{name:"defaultPaymentOption",value:a.defaultPaymentOption,onValueChange:t=>(r({...a,defaultPaymentOption:t}),n(!0)),children:[e.jsx(T,{className:"w-[180px]",children:e.jsx(q,{})}),e.jsx(F,{children:e.jsxs(M,{children:[e.jsx(o,{value:"ON_SITE",children:"Sur place"}),e.jsx(o,{value:"DEPOSIT",children:"Acompte"}),e.jsx(o,{value:"FULL",children:"Complet"})]})})]}),e.jsxs("p",{className:"text-muted text-sm",children:["Cette option de paiement par défaut sera utilisé pour les prestations qui n'ont pas d'option de paiement spécifique configuré."," ",e.jsx("br",{})," ",e.jsx("br",{})]}),a.defaultPaymentOption==="ON_SITE"&&e.jsxs("p",{className:"text-muted text-sm",children:[e.jsx("span",{className:"font-semibold text-primary",children:"Sur place"})," : Aucun paiement ne sera demandé au client lors de la réservation."]}),a.defaultPaymentOption==="DEPOSIT"&&e.jsxs("p",{className:"text-muted text-sm",children:[e.jsx("span",{className:"font-semibold text-primary",children:"Acompte"})," : Un acompte sera demandé au client lors de la réservation."]}),a.defaultPaymentOption==="FULL"&&e.jsxs("p",{className:"text-muted text-sm",children:[e.jsx("span",{className:"font-semibold text-primary",children:"Complet"})," : Le client devra payer la totalité de la prestation lors de la réservation."]})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"defaultDeposit",children:"Acompte par défaut"}),e.jsxs("div",{className:"flex items-center gap-2 w-2/3",children:[e.jsx(y,{name:"defaultDeposit",type:"number",value:a.defaultDeposit,onChange:L,className:"w-fit"}),e.jsx("span",{children:"%"})]}),e.jsxs("p",{className:"text-muted text-sm",children:["L'acompte par défaut sera utilisé pour les prestations qui n'ont pas d'acompte spécifique configuré. ",e.jsx("br",{})," ",e.jsx("br",{}),e.jsx("span",{className:"font-semibold",children:"Exemple:"})," Pour une prestation à ",e.jsx("span",{className:"font-semibold text-primary",children:"50€"})," avec"," ",e.jsxs("span",{className:"font-semibold text-primary",children:[a.defaultDeposit,"%"]})," ","d'acompte, le client devra payer"," ",e.jsxs("span",{className:"font-semibold text-primary",children:[A(a.defaultDeposit),"€"]})," ","à la réservation."]})]}),P&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{onClick:w,disabled:f,children:f?e.jsx(N,{className:"animate-spin"}):"Enregstrer"}),e.jsx(c,{variant:"outline",onClick:O,children:"Annuler"})]})]})]}):e.jsxs("main",{className:"w-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col gap-4",children:[e.jsx(S,{}),e.jsx("h1",{className:"text-3xl font-semibold",children:"Mes paiements"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx(y,{disabled:!0,value:s.email,className:"w-fit"}),e.jsx(c,{onClick:D,className:"w-fit",disabled:u||s.stripeConnectedAccountId,children:u?e.jsx(N,{className:"animate-spin"}):"Créer un compte connecté"})]}),e.jsx("p",{className:"text-muted text-sm",children:"Créez un compte connecté avec l'email de votre salon pour mettre en place des paiements en ligne."})]})}const S=()=>e.jsx(J,{children:e.jsxs(R,{children:[e.jsx(d,{children:e.jsx(m,{asChild:!0,children:e.jsx(p,{to:"/",children:"Tableau de bord"})})}),e.jsx(v,{}),e.jsx(d,{children:e.jsx(m,{asChild:!0,children:e.jsx(p,{to:"/salon",children:"Salon"})})}),e.jsx(v,{}),e.jsx(d,{children:e.jsx(m,{asChild:!0,children:e.jsx(p,{to:"/salon/payment",children:"Paiements"})})})]})});export{H as default};
