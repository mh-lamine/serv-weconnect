import{c as B,j as e,a as D,b as F,r as u,B as m,u as M,d as O,e as G,L as T}from"./index-B486AUvC.js";import{M as C}from"./ModalAction-CjVAzUEQ.js";import{P as H,a as U,b as q}from"./popover-ABmA_xW_.js";import{u as Q,D as _,a as J,b as K,c as W,d as X,e as Y,f as Z,g as ee,h as se,i as ae}from"./drawer-BrYnPEFv.js";import{A as re,a as L,b as P,c as k}from"./accordion-0QOouO5Z.js";import{A as te,a as ne,b as le}from"./avatar-su2Ttd1B.js";import{B as ie,a as ce,b as oe,c as de}from"./breadcrumb-BtR7b3zS.js";import{T as ue,a as g,b as me,c as S}from"./tabs-CIA6XOHy.js";import{u as xe}from"./useAxiosPrivate-CBGOQ5PF.js";import{g as he}from"./formatting-Cw3qGvmM.js";import"./axiosPrivate-DIfOmtDf.js";import"./index-DvpKj6As.js";import"./index-C8mOZ_YV.js";import"./chevron-down-keh-6Msr.js";import"./index-C0cnp9H3.js";/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=B("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),fe=F("inline-flex items-center rounded-full border px-2.5 py-0.5 text-sm w-fit font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-light",outline:"border-transparent bg-dark/10",success:"border-transparent bg-success text-light"}},defaultVariants:{variant:"default"}});function p({className:s,variant:i,...n}){return e.jsx("div",{className:D(fe({variant:i}),s),...n})}const ve=({client:s})=>{const[i,n]=u.useState(!1),{firstName:d,lastName:l,phoneNumber:c}=s;return Q("(min-width: 768px)")?e.jsxs(_,{open:i,onOpenChange:n,children:[e.jsx(J,{asChild:!0,children:e.jsx(m,{className:"w-full",variant:"outline",children:"Voir la fiche client"})}),e.jsxs(K,{className:"sm:max-w-[425px]",children:[e.jsx(W,{children:e.jsxs(X,{className:"flex text-xl",children:["Fiche client de ",e.jsxs("p",{className:"text-primary",children:[d," ",l]})]})}),e.jsx("ul",{className:"font-light",children:e.jsxs("li",{children:[e.jsx("b",{children:"Numéro de téléphone:"})," ",e.jsx(m,{variant:"link",children:e.jsx("a",{href:`tel:${c}`,children:c.replace(/(\d{2})(?=\d)/g,"$1 ")})})]})})]})]}):e.jsxs(Y,{open:i,onOpenChange:n,children:[e.jsx(Z,{asChild:!0,children:e.jsx(m,{className:"w-full",variant:"outline",children:"Voir la fiche client"})}),e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(ae,{className:"text-primary",children:["Voir la fiche client de ",d," ",l]})}),e.jsx("ul",{children:e.jsxs("li",{children:[e.jsx("b",{children:"Numéro de téléphone:"})," ",c]})})]})]})},ge=({appointment:s,acceptAppointment:i,cancelAppointment:n,today:d=!1,past:l=!1,isAdmin:c=!1})=>e.jsxs("div",{className:`flex flex-col gap-2 py-2 ${l&&"text-muted"}`,children:[e.jsx("div",{className:"divider divider-start my-0",children:e.jsxs(H,{children:[e.jsx(U,{asChild:!0,children:e.jsx(m,{variant:"link",className:"text-dark",children:e.jsxs("h2",{className:"text-xl font-semibold",children:[s.client.firstName," ",s.client.lastName]})})}),e.jsx(q,{align:"start",className:"w-fit flex flex-col gap-2",children:e.jsx(ve,{client:s.client})})]})}),e.jsx("div",{className:"flex flex-col md:flex-row md:gap-4",children:e.jsx(m,{variant:"link",className:`w-fit py-0 ${l&&"text-muted"}`,children:e.jsx("a",{href:`tel:${s.client.phoneNumber}`,children:s.client.phoneNumber.replace(/(\d{2})(?=\d)/g,"$1 ")})})}),e.jsxs("h3",{className:"text-lg",children:[e.jsx("span",{className:"font-medium",children:s.service.name})," ",e.jsx("br",{}),!d&&e.jsxs(e.Fragment,{children:["le"," ",e.jsxs("span",{className:"font-medium",children:[new Date(s.date).toLocaleDateString("fr-FR",{weekday:"long",month:"long",day:"numeric"}).toUpperCase()," "]})]}),"à"," ",e.jsx("span",{className:"font-medium",children:new Date(s.date).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]}),s.status==="PENDING"&&e.jsx(p,{variant:"outline",className:l&&"bg-muted",children:"En attente de confirmation"}),s.status==="ACCEPTED"&&e.jsx(p,{className:l&&"bg-muted",children:"Rendez-vous confirmé"}),s.status==="COMPLETED"&&e.jsx(p,{variant:"success",className:l&&"bg-muted",children:"Passé"}),s.status==="CANCELLED"&&e.jsx(p,{variant:"destructive",className:l&&"bg-muted",children:"Annulé"}),c&&s.status==="PENDING"&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx(C,{id:s.id,action:i,actionLabel:"Accepter",title:"Accepter le rendez-vous",description:"Êtes-vous sûr de vouloir accepter ce rendez-vous ?",successMessage:"Rendez-vous accepté",trigger:"Accepter",variant:"success"}),e.jsx(C,{id:s.id,action:n,actionLabel:"Refuser",title:"Refuser le rendez-vous",description:"Êtes-vous sûr de vouloir refuser ce rendez-vous ?",successMessage:"Rendez-vous refusé",trigger:"Refuser",variant:"destructive"})]}),c&&s.status==="ACCEPTED"&&e.jsx("div",{className:"ml-auto",children:e.jsx(C,{id:s.id,action:n,actionLabel:"Annuler",title:"Annuler le rendez-vous",description:"Êtes-vous sûr de vouloir annuler ce rendez-vous ?",successMessage:"Rendez-vous annulé",trigger:"Annuler",variant:"destructive"})})]}),N=ge;function r({className:s,...i}){return e.jsx("div",{className:D("animate-pulse rounded-md bg-muted",s),...i})}const pe=()=>{const{setAuth:s}=M();return async()=>{s(null);try{await O.get("/api/auth/logout",{withCredentials:!0})}catch(n){console.error(n)}}},Ne=pe;function $e(){const[s,i]=u.useState(),[n,d]=u.useState(!0),[l,c]=u.useState(),[x,E]=u.useState(),V=Ne(),{auth:b}=M(),o=(b==null?void 0:b.role)==="SALON",h=xe(),I=G();async function w(){const a=o?"/api/appointments/provider":"/api/appointments/member";try{const{data:t}=await h.get(a);i(t)}catch(t){console.error(t)}}async function z(a){try{await h.patch(`/api/appointments/${a}`,{status:"ACCEPTED"}),w()}catch(t){console.error(t)}}async function y(a){try{await h.patch(`/api/appointments/${a}`,{status:"CANCELLED"}),w()}catch(t){console.error(t)}}const j=(a,t)=>a.filter(v=>v.status===t&&(!x||v.memberId===x)).sort((v,$)=>new Date(v.date)-new Date($.date)),R=async()=>{await V(),I("/login")};u.useEffect(()=>{async function a(){try{const{data:t}=await h.get("/api/salon/members");c(t),await w()}catch(t){console.error(t)}finally{d(!1)}}a()},[]);const f=(s==null?void 0:s.todaysAppointments)||[],A=(s==null?void 0:s.futureAppointments)||[];return e.jsxs("main",{className:"w-full h-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col gap-4",children:[e.jsx(ie,{className:"h-0 p-0",children:e.jsx(ce,{children:e.jsx(oe,{children:e.jsx(de,{asChild:!0,children:e.jsx(T,{to:"/",children:"Tableau de bord"})})})})}),e.jsxs(ue,{defaultValue:"today",className:"space-y-4",children:[e.jsx(g,{value:"today",children:e.jsx("h1",{className:"text-3xl font-semibold",children:"Mes rendez-vous de la journée"})}),e.jsx(g,{value:"incoming",children:e.jsx("h1",{className:"text-3xl font-semibold",children:"Mes rendez-vous à venir"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(me,{children:[e.jsx(S,{value:"today",children:"Aujourd'hui"}),e.jsx(S,{value:"incoming",children:"À venir"})]}),o&&e.jsx(T,{to:"/salon",children:e.jsx(je,{size:24,className:"text-primary"})})]}),e.jsxs(g,{value:"today",className:"space-y-4",children:[o&&(n?e.jsx(be,{}):e.jsx("div",{className:"-space-x-4",children:l==null?void 0:l.map((a,t)=>e.jsx("button",{className:`z-[${t}]`,onClick:x==a.id?()=>E(null):()=>E(a.id),children:e.jsxs(te,{className:D("w-12","h-12","border-2",x==a.id?"border-primary":"border-white"),children:[e.jsx(ne,{src:a.profilePicture}),e.jsx(le,{className:"text-md",children:he(a.firstName,a.lastName)})]})}))})),n?e.jsx(we,{}):f.length?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-muted",children:["Vous avez ",f.length," rendez-vous aujourd'hui."]}),j(f,"ACCEPTED").map(a=>e.jsx(N,{appointment:a,cancelAppointment:y,today:!0,isAdmin:o},a.id)),e.jsx("div",{className:"divider divider-start text-muted",children:"Mes rendez-vous passés"}),j(f,"COMPLETED").map(a=>e.jsx(N,{appointment:a,past:!0,today:!0,isAdmin:o},a.id))]}):e.jsxs("p",{className:"text-muted",children:[" ","Vous n'avez aucun rendez-vous aujourd'hui."]})]}),e.jsx(g,{value:"incoming",children:n?e.jsx("p",{children:"Fetching"}):A.length?e.jsxs(re,{type:"single",collapsible:!0,defaultValue:"item-0",className:"w-full space-y-4",children:[e.jsxs(L,{value:"item-0",children:[e.jsx(P,{children:e.jsxs("p",{className:"text-muted",children:["Vous avez"," ",s.futureAppointments.filter(a=>a.status==="PENDING").length," ","demande(s) en attente."]})}),e.jsx(k,{children:j(A,"PENDING").map(a=>e.jsx(N,{appointment:a,acceptAppointment:z,cancelAppointment:y,isAdmin:o},a.id))})]}),e.jsxs(L,{value:"item-1",children:[e.jsx(P,{children:e.jsxs("p",{className:"text-muted",children:["Vous avez"," ",s.futureAppointments.filter(a=>a.status==="ACCEPTED").length," ","rendez-vous à venir."]})}),e.jsx(k,{children:j(A,"ACCEPTED").map(a=>e.jsx(N,{appointment:a,acceptAppointment:z,cancelAppointment:y,isAdmin:o},a.id))})]})]}):e.jsx("p",{className:"text-muted",children:"Vous n'avez aucun rendez-vous à venir."})})]}),e.jsx(m,{variant:"destructive",onClick:R,className:"w-fit mt-auto",children:"Se déconnecter"})]})}const be=()=>e.jsxs("div",{className:"flex -space-x-4",children:[e.jsx(r,{className:"h-12 w-12 rounded-full border-2 animate-pulse"}),e.jsx(r,{className:"h-12 w-12 rounded-full border-2 animate-pulse"}),e.jsx(r,{className:"h-12 w-12 rounded-full border-2 animate-pulse"})]}),we=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsx(r,{className:"h-4 w-2/3"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r,{className:"h-4 w-1/4"}),e.jsx(r,{className:"h-1 w-3/4"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(r,{className:"h-4 w-1/3"}),e.jsx(r,{className:"h-4 w-1/3"}),e.jsx(r,{className:"h-6 w-1/2 rounded-xl"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{className:"h-10 w-24 rounded-sm"}),e.jsx(r,{className:"h-10 w-24 rounded-sm"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r,{className:"h-4 w-1/4"}),e.jsx(r,{className:"h-1 w-3/4"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(r,{className:"h-4 w-1/3"}),e.jsx(r,{className:"h-4 w-1/3"}),e.jsx(r,{className:"h-6 w-1/2 rounded-xl"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{className:"h-10 w-24 rounded-sm"}),e.jsx(r,{className:"h-10 w-24 rounded-sm"})]})]});export{$e as default};
