import{r as n,m as y,j as e,D as w,n as D,B as t,o as S,p as b,q as A,s as k,I as N,t as F,v as z,L as C,w as E,x as T,y as L,z as O,A as M,C as P,F as I,G as R,u as H,a as q,b as G,E as Q}from"./index-BD-xntd6.js";import{L as g}from"./label-D4AbbYFG.js";import{C as U,a as V}from"./circle-plus-DnPUK8Xg.js";const $=({createCategory:j})=>{const[h,o]=n.useState(!1),[i,s]=n.useState(),[l,r]=n.useState(!1),[c,u]=n.useState(),d=y("(min-width: 768px)"),f=v=>{const{name:a,value:x}=v.target;s({[a]:x})},m=async v=>{if(v.preventDefault(),!(i!=null&&i.name)){u("Veuillez renseigner le nom de la catégorie.");return}r(!0);try{await j(i)}catch{u("Une erreur est survenue, veuillez réessayer plus tard.")}r(!1),o(!1)};return n.useEffect(()=>{h||s()},[h]),d?e.jsxs(w,{open:h,onOpenChange:o,children:[e.jsx(D,{asChild:!0,children:e.jsx(t,{variant:"link",className:"p-0 h-min",children:"Ajouter une catégorie"})}),e.jsxs(S,{className:"sm:max-w-[425px]",children:[e.jsxs(b,{children:[e.jsx(A,{children:"Ajouter une catégorie"}),e.jsx(k,{children:"Définissez un nom pour ajouter une catégorie."})]}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{children:[e.jsx(g,{htmlFor:"name",children:"Nom"}),e.jsx(N,{id:"name",name:"name",type:"text",onChange:f})]})}),c&&setTimeout(()=>u(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:c}),e.jsx(F,{className:"sm:justify-start",children:e.jsx(z,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(t,{variant:"outline",onClick:()=>s(),children:"Annuler"}),e.jsx(t,{onClick:m,disabled:l&&!0,children:l?e.jsx(C,{className:"animate-spin"}):"Ajouter"})]})})})]})]}):e.jsxs(E,{open:h,onOpenChange:o,children:[e.jsx(T,{asChild:!0,children:e.jsx(t,{variant:"link",className:"p-0 h-min",children:"Ajouter une catégorie"})}),e.jsxs(L,{children:[e.jsxs(O,{className:"text-left",children:[e.jsx(M,{children:"Ajouter une categorie"}),e.jsx(P,{children:"Définissez un nom pour ajouter une categorie."})]}),e.jsx("div",{className:"flex flex-col px-4 gap-2",children:e.jsxs("div",{children:[e.jsx(g,{htmlFor:"name",children:"Nom"}),e.jsx(N,{id:"name",name:"name",type:"text",onChange:f})]})}),e.jsxs(I,{className:"pt-2",children:[c&&setTimeout(()=>u(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:c}),e.jsx(R,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"w-full",onClick:m,disabled:l&&!0,children:l?e.jsx(C,{className:"animate-spin"}):"Ajouter"}),e.jsx(t,{className:"w-full",variant:"outline",onClick:()=>s(),children:"Annuler"})]})})]})]})]})},J=({providerCategoryId:j,createService:h})=>{const[o,i]=n.useState(!1),[s,l]=n.useState(),[r,c]=n.useState(!1),[u,d]=n.useState(),f=y("(min-width: 768px)"),m=a=>{const{name:x,value:p}=a.target,B=x==="price"||x==="duration"?parseFloat(p):p;l({...s,[x]:B})},v=async a=>{if(a.preventDefault(),!(s!=null&&s.name)||!(s!=null&&s.price)||!(s!=null&&s.duration)){d("Veuillez renseigner tous les champs.");return}c(!0);try{await h({providerCategoryId:j,...s})}catch{d("Une erreur est survenue, veuillez réessayer plus tard.")}c(!1),i(!1)};return n.useEffect(()=>{o||l()},[o]),f?e.jsxs(w,{open:o,onOpenChange:i,children:[e.jsx(D,{asChild:!0,children:e.jsx(t,{variant:"outline",children:e.jsx(U,{})})}),e.jsxs(S,{className:"sm:max-w-[425px]",children:[e.jsxs(b,{children:[e.jsx(A,{children:"Ajouter une prestation"}),e.jsx(k,{children:"Définissez un nom, un prix et une durée pour ajouter une prestation."})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"name",children:"Nom"}),e.jsx(N,{id:"name",name:"name",type:"text",onChange:m})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"price",children:"Prix"}),e.jsx(N,{id:"price",name:"price",type:"number",onChange:m})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"duration",children:"Durée"}),e.jsx(N,{id:"duration",name:"duration",type:"number",onChange:m})]})]}),u&&setTimeout(()=>d(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:u}),e.jsx(F,{className:"sm:justify-start",children:e.jsx(z,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(t,{variant:"outline",onClick:()=>l(),children:"Annuler"}),e.jsx(t,{onClick:v,disabled:r&&!0,children:r?e.jsx(C,{className:"animate-spin"}):"Ajouter"})]})})})]})]}):e.jsxs(E,{open:o,onOpenChange:i,children:[e.jsx(T,{asChild:!0,children:e.jsx(t,{variant:"outline",children:e.jsx(U,{})})}),e.jsxs(L,{children:[e.jsxs(O,{className:"text-left",children:[e.jsx(M,{children:"Ajouter une prestation"}),e.jsx(P,{children:"Définissez un nom, un prix et une durée pour ajouter une prestation."})]}),e.jsxs("div",{className:"flex flex-col px-4 gap-2",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"name",children:"Nom"}),e.jsx(N,{id:"name",name:"name",type:"text",onChange:m})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"price",children:"Prix"}),e.jsx(N,{id:"price",name:"price",type:"number",onChange:m})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"duration",children:"Durée"}),e.jsx(N,{id:"duration",name:"duration",type:"number",onChange:m})]})]}),e.jsxs(I,{className:"pt-2",children:[u&&setTimeout(()=>d(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:u}),e.jsx(R,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"w-full",onClick:v,disabled:r&&!0,children:r?e.jsx(C,{className:"animate-spin"}):"Ajouter"}),e.jsx(t,{className:"w-full",variant:"outline",onClick:()=>l(),children:"Annuler"})]})})]})]})]})},K=({id:j,removeService:h})=>{const[o,i]=n.useState(!1),[s,l]=n.useState(!1),[r,c]=n.useState(),u=y("(min-width: 768px)"),d=async f=>{f.preventDefault(),l(!0);try{await h(j)}catch{c("Une erreur est survenue, veuillez réessayer plus tard.")}l(!1),i(!1)};return u?e.jsxs(w,{open:o,onOpenChange:i,children:[e.jsx(D,{asChild:!0,children:e.jsx(t,{variant:"ghost",className:"ml-4",children:e.jsx(V,{className:"text-destructive"})})}),e.jsxs(S,{className:"sm:max-w-[425px]",children:[e.jsxs(b,{children:[e.jsx(A,{className:"text-destructive",children:"Supprimer une prestation"}),e.jsx(k,{children:"Êtes-vous sûr de vouloir supprimer cette prestation ?"})]}),r&&setTimeout(()=>c(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:r}),e.jsx(F,{className:"sm:justify-start",children:e.jsx(z,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(t,{variant:"outline",children:"Annuler"}),e.jsx(t,{onClick:d,variant:"destructive",disabled:s&&!0,children:s?e.jsx(C,{className:"animate-spin"}):"Supprimer"})]})})})]})]}):e.jsxs(E,{open:o,onOpenChange:i,children:[e.jsx(T,{asChild:!0,children:e.jsx(t,{variant:"ghost",className:"ml-4",children:e.jsx(V,{className:"text-destructive"})})}),e.jsxs(L,{children:[e.jsxs(O,{className:"text-left",children:[e.jsx(M,{className:"text-destructive",children:"Supprimer une prestation"}),e.jsx(P,{children:"Êtes-vous sûr de vouloir supprimer cette prestation ?"})]}),e.jsxs(I,{className:"pt-2",children:[r&&setTimeout(()=>c(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:r}),e.jsx(R,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{className:"w-full",onClick:d,variant:"destructive",disabled:s&&!0,children:s?e.jsx(C,{className:"animate-spin"}):"Supprimer"}),e.jsx(t,{className:"w-full",variant:"outline",children:"Annuler"})]})})]})]})]})},Z=()=>{const[j,h]=n.useState(),[o,i]=n.useState(),[s,l]=n.useState(!0),r=H(),c=q(),u=G();n.useEffect(()=>{d()},[]);async function d(){var a;try{const x=await r.get("/api/providerCategory/me");h(x.data)}catch(x){i(x),((a=x.response)==null?void 0:a.status)===401&&c("/login",{state:{from:u},replace:!0})}l(!1)}async function f(a){await r.post("/api/providerService",a),d()}async function m(a){await r.post("/api/providerCategory",a),d()}async function v(a){await r.delete(`/api/providerService/${a}`),d()}return s?e.jsx(C,{className:"w-8 h-8 animate-spin flex-1"}):o?e.jsx(Q,{}):e.jsxs("main",{className:"w-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col space-y-4",children:[e.jsx(t,{variant:"link",className:"justify-start h-0 p-0",onClick:()=>c(-1),children:"Retour"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold",children:"Mes prestations"}),e.jsx($,{createCategory:m})]}),j==null?void 0:j.map((a,x)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-medium",children:a.name}),e.jsx(J,{providerCategoryId:a.id,createService:f})]}),e.jsx("ul",{className:"space-y-2",children:a.services.map(p=>e.jsx("li",{className:"flex items-center justify-between gap-4",children:e.jsxs("div",{className:"w-full rounded-md p-4 pr-0 bg-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{children:p.name}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("p",{children:[p.duration,"mn"]}),e.jsx("div",{className:"divider divider-horizontal"}),e.jsxs("p",{children:[p.price,"€"]}),e.jsx(K,{id:p.id,removeService:v})]})]}),e.jsx("p",{children:p.description})]})},p.id))})]},x))]})};export{Z as default};
