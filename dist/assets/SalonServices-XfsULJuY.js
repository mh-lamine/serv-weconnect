import{r as i,m as D,j as e,D as S,n as b,B as r,o as A,p as k,q as F,s as E,I as f,t as L,v as T,L as g,w as z,x as O,y as M,z as P,A as H,C as I,F as R,G as B,H as V,u as $,a as q,b as G,E as Q}from"./index-QoA8-fy5.js";import{L as v}from"./label-CYw2kLPO.js";import{C as w,a as y}from"./circle-plus-BRl21M6W.js";const J=({providerCategoryId:j,createService:N})=>{const[c,d]=i.useState(!1),[s,o]=i.useState(),[a,l]=i.useState(!1),[u,x]=i.useState(),p=D("(min-width: 768px)"),m=t=>{const{name:n,value:h}=t.target,U=n==="price"||n==="duration"?parseFloat(h):h;o({...s,[n]:U})},C=async t=>{if(console.log("submitting"),t.preventDefault(),!(s!=null&&s.name)||!(s!=null&&s.price)||!(s!=null&&s.duration)){x("Veuillez renseigner tous les champs.");return}l(!0);try{await N({providerCategoryId:j,...s})}catch{x("Une erreur est survenue, veuillez réessayer plus tard.")}l(!1),d(!1)};return i.useEffect(()=>{c||o()},[c]),p?e.jsxs(S,{open:c,onOpenChange:d,children:[e.jsx(b,{asChild:!0,children:e.jsx(r,{children:e.jsx(w,{})})}),e.jsxs(A,{className:"sm:max-w-[425px]",children:[e.jsxs(k,{children:[e.jsx(F,{children:"Ajouter une prestation"}),e.jsx(E,{children:"Définissez un nom, un prix et une durée pour ajouter une prestation."})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"name",children:"Nom"}),e.jsx(f,{id:"name",name:"name",type:"text",onChange:m})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"price",children:"Prix"}),e.jsx(f,{id:"price",name:"price",type:"number",onChange:m})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"duration",children:"Durée"}),e.jsx(f,{id:"duration",name:"duration",type:"number",onChange:m})]})]}),u&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:u}),e.jsx(L,{className:"sm:justify-start",children:e.jsx(T,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(r,{variant:"outline",onClick:()=>o(),children:"Annuler"}),e.jsx(r,{onClick:C,disabled:a&&!0,children:a?e.jsx(g,{className:"animate-spin"}):"Ajouter"})]})})})]})]}):e.jsxs(z,{open:c,onOpenChange:d,children:[e.jsx(O,{asChild:!0,children:e.jsx(r,{children:e.jsx(w,{})})}),e.jsxs(M,{children:[e.jsxs(P,{className:"text-left",children:[e.jsx(H,{children:"Ajouter une prestation"}),e.jsx(I,{children:"Définissez un nom, un prix et une durée pour ajouter une prestation."})]}),e.jsxs("div",{className:"flex flex-col px-4 gap-2",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"name",children:"Nom"}),e.jsx(f,{id:"name",name:"name",type:"text",onChange:m})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"price",children:"Prix"}),e.jsx(f,{id:"price",name:"price",type:"number",onChange:m})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"duration",children:"Durée"}),e.jsx(f,{id:"duration",name:"duration",type:"number",onChange:m})]})]}),e.jsxs(R,{className:"pt-2",children:[u&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:u}),e.jsx(B,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{className:"w-full",onClick:C,disabled:a&&!0,children:a?e.jsx(g,{className:"animate-spin"}):"Ajouter"}),e.jsx(r,{className:"w-full",variant:"outline",onClick:()=>o(),children:"Annuler"})]})})]})]})]})},K=({id:j,removeService:N})=>{const[c,d]=i.useState(!1),[s,o]=i.useState(!1),[a,l]=i.useState(),u=D("(min-width: 768px)"),x=async p=>{p.preventDefault(),o(!0);try{await N(j)}catch{l("Une erreur est survenue, veuillez réessayer plus tard.")}o(!1),d(!1)};return u?e.jsxs(S,{open:c,onOpenChange:d,children:[e.jsx(b,{asChild:!0,children:e.jsx(r,{variant:"outline",children:e.jsx(y,{className:"text-destructive"})})}),e.jsxs(A,{className:"sm:max-w-[425px]",children:[e.jsxs(k,{children:[e.jsx(F,{className:"text-destructive",children:"Supprimer une prestation"}),e.jsx(E,{children:"Êtes-vous sûr de vouloir supprimer cette prestation ?"})]}),a&&setTimeout(()=>l(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:a}),e.jsx(L,{className:"sm:justify-start",children:e.jsx(T,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(r,{variant:"outline",children:"Annuler"}),e.jsx(r,{onClick:x,variant:"destructive",disabled:s&&!0,children:s?e.jsx(g,{className:"animate-spin"}):"Supprimer"})]})})})]})]}):e.jsxs(z,{open:c,onOpenChange:d,children:[e.jsx(O,{asChild:!0,children:e.jsx(r,{variant:"outline",children:e.jsx(y,{className:"text-destructive"})})}),e.jsxs(M,{children:[e.jsxs(P,{className:"text-left",children:[e.jsx(H,{className:"text-destructive",children:"Supprimer une prestation"}),e.jsx(I,{children:"Êtes-vous sûr de vouloir supprimer cette prestation ?"})]}),e.jsxs(R,{className:"pt-2",children:[a&&setTimeout(()=>l(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:a}),e.jsx(B,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{className:"w-full",onClick:x,variant:"destructive",disabled:s&&!0,children:s?e.jsx(g,{className:"animate-spin"}):"Supprimer"}),e.jsx(r,{className:"w-full",variant:"outline",children:"Annuler"})]})})]})]})]})},Z=()=>{const[j,N]=i.useState(),[c,d]=i.useState(),[s,o]=i.useState(!0),{auth:a}=V(),l=$(),u=q(),x=G();i.useEffect(()=>{p()},[a.id]);async function p(){var t;try{const n=await l.get(`/api/providerCategory/${a.id}`);N(n.data)}catch(n){d(n),((t=n.response)==null?void 0:t.status)===401&&u("/login",{state:{from:x},replace:!0})}o(!1)}async function m(t){await l.post("/api/providerService",t),p()}async function C(t){await l.delete(`/api/providerService/${t}`),p()}return s?e.jsx(g,{className:"w-8 h-8 animate-spin flex-1"}):c?e.jsx(Q,{}):e.jsxs("main",{className:"w-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col space-y-4",children:[e.jsx(r,{variant:"link",className:"justify-start h-0 p-0",onClick:()=>u(-1),children:"Retour"}),e.jsx("h1",{className:"text-3xl font-semibold",children:"Mes prestations"}),j==null?void 0:j.map((t,n)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-medium",children:t.name}),e.jsx(J,{providerCategoryId:t.id,createService:m})]}),e.jsx("ul",{className:"space-y-2",children:t.services.map(h=>e.jsxs("li",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"w-full rounded-md p-4 bg-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{children:h.name}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("p",{children:[h.duration,"mn"]}),e.jsx("div",{className:"divider divider-horizontal"}),e.jsxs("p",{children:[h.price,"€"]})]})]}),e.jsx("p",{children:h.description})]}),e.jsx(K,{id:h.id,removeService:C})]},h.id))})]},n))]})};export{Z as default};
