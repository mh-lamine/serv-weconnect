import{c as S,r as i,u as T,j as e,D as b,a as M,B as d,b as k,h as E,i as L,k as O,J as f,l as Y,K as R,L as w,d as z,e as F,f as U,g as V,M as H,N as I,O as P,Q as B,n as J,o as Q,F as $,R as K}from"./index-DXOpZwJG.js";import{C as A}from"./circle-plus-B69meiRa.js";/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=S("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]),q=({dayOfWeek:u,createAvailability:m})=>{const[s,x]=i.useState(!1),[a,n]=i.useState(),[l,c]=i.useState(!1),[o,h]=i.useState(),g=T("(min-width: 768px)"),j=p=>{n({...a,[p.target.name]:p.target.value})},N=async p=>{if(p.preventDefault(),!(a!=null&&a.startTime)||!(a!=null&&a.endTime)){h("Veuillez renseigner une heure de début et une heure de fin.");return}c(!0);try{await m({dayOfWeek:u,...a}),x(!1)}catch{h("Une erreur est survenue, veuillez réessayer plus tard.")}c(!1)};return i.useEffect(()=>{s||n()},[s]),g?e.jsxs(b,{open:s,onOpenChange:x,children:[e.jsx(M,{asChild:!0,children:e.jsx(d,{children:e.jsx(A,{})})}),e.jsxs(k,{className:"sm:max-w-[425px]",children:[e.jsxs(E,{children:[e.jsx(L,{children:"Ajouter un créneau"}),e.jsx(O,{children:"Selectionnez une heure de début et une heure de fin pour créer un créneau de disponibilité."})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:["De",e.jsx(f,{className:"w-fit",name:"startTime",type:"time",onChange:j}),"à",e.jsx(f,{className:"w-fit",name:"endTime",type:"time",onChange:j})]}),o&&setTimeout(()=>h(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:o}),e.jsx(Y,{className:"sm:justify-start",children:e.jsx(R,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(d,{variant:"outline",onClick:()=>n(),children:"Annuler"}),e.jsx(d,{onClick:N,disabled:l&&!0,children:l?e.jsx(w,{className:"animate-spin"}):"Ajouter"})]})})})]})]}):e.jsxs(z,{open:s,onOpenChange:x,children:[e.jsx(F,{asChild:!0,children:e.jsx(d,{children:e.jsx(A,{})})}),e.jsxs(U,{children:[e.jsxs(V,{children:[e.jsx(H,{children:"Ajouter un créneau"}),e.jsx(I,{children:"Selectionnez une heure de début et une heure de fin pour créer un créneau de disponibilité."})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 px-4",children:["De",e.jsx(f,{className:"w-fit",name:"startTime",type:"time",onChange:j}),"à",e.jsx(f,{className:"w-fit",name:"endTime",type:"time",onChange:j})]}),e.jsxs(P,{className:"pt-2",children:[o&&setTimeout(()=>h(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:o}),e.jsx(B,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{className:"w-full",onClick:N,disabled:l&&!0,children:l?e.jsx(w,{className:"animate-spin"}):"Ajouter"}),e.jsx(d,{className:"w-full",variant:"outline",onClick:()=>n(),children:"Annuler"})]})})]})]})]})},_=()=>{const u={Lundi:"MONDAY",Mardi:"TUESDAY",Mercredi:"WEDNESDAY",Jeudi:"THURSDAY",Vendredi:"FRIDAY",Samedi:"SATURDAY",Dimanche:"SUNDAY"},[m,s]=i.useState(),[x,a]=i.useState(),[n,l]=i.useState(!0),c=J(),o=Q(),h=$();i.useEffect(()=>{g()},[]);async function g(){var t;try{const r=await c.get("/api/availabilities");s(p(r.data))}catch(r){a(r),((t=r.response)==null?void 0:t.status)===401&&o("/login",{state:{from:h},replace:!0})}l(!1)}async function j(t){await c.post("/api/availabilities",t),g()}async function N(t){await c.delete(`/api/availabilities/${t}`),g()}function p(t){const r={};return t==null||t.forEach(({id:D,dayOfWeek:y,startTime:v,endTime:C})=>{r[y]||(r[y]=[]),r[y].push({id:D,start:v,end:C})}),r}return n?e.jsx(w,{className:"w-8 h-8 animate-spin flex-1"}):e.jsxs("main",{className:"w-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col space-y-4",children:[e.jsx(d,{variant:"link",className:"justify-start h-0 p-0",onClick:()=>o(-1),children:"Retour"}),e.jsx("h1",{className:"text-3xl font-semibold",children:"Mes disponibilités"}),Object.entries(u).map(([t,r],D)=>e.jsxs("div",{children:[e.jsx(G,{dayFR:t,dayEN:r,availabilities:m&&m[r],createAvailability:j,removeAvailability:N}),D!==Object.entries(u).length-1&&e.jsx("div",{className:"divider w-1/2 mx-auto"})]},D))]})},G=({dayFR:u,dayEN:m,availabilities:s,createAvailability:x,removeAvailability:a})=>e.jsxs("section",{className:`flex flex-col sm:flex-row gap-4 ${!(s!=null&&s.length)&&"text-muted sm:items-center"}`,children:[e.jsx("span",{className:"text-xl font-medium sm:flex-1",children:u}),s!=null&&s.length?e.jsx("div",{className:"space-y-2 sm:flex-2",children:s==null?void 0:s.map(({id:n,start:l,end:c},o)=>e.jsxs("div",{className:"flex gap-4",children:[e.jsx(f,{disabled:!0,type:"time",defaultValue:l,className:"!opacity-100"}),e.jsx("div",{className:"divider divider-horizontal m-0"}),e.jsx(f,{disabled:!0,type:"time",defaultValue:c,className:"!opacity-100"}),e.jsx(K,{id:n,action:a,actionLabel:"Supprimer",buttonVariant:"ghost",title:"Supprimer un créneau",description:"Êtes-vous sûr de vouloir supprimer ce créneau de disponibilité ?",trigger:e.jsx(W,{className:"text-destructive"})})]},n))}):e.jsx("div",{className:"sm:flex-2",children:"Fermé"}),e.jsx("div",{className:"flex sm:flex-1 justify-end",children:e.jsx(q,{dayOfWeek:m,createAvailability:x})})]});export{_ as default};
