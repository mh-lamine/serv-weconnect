import{m as J,r as c,n as D,j as e,D as k,o as S,B as i,p as F,q as z,s as M,t as T,I as N,v as E,w as O,L as b,x as L,y as R,z as V,A as P,C as I,F as U,G as $,H,l as Q,u as W,a as X,b as Y,J as Z,K as _,M as ee}from"./index-CZ0MA7bG.js";import{L as p}from"./label-C1zazEnY.js";import{C as B}from"./circle-plus-BKEr5bOm.js";/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=J("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=J("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),ie=({createCategory:d})=>{const[f,m]=c.useState(!1),[r,t]=c.useState(),[l,n]=c.useState(!1),[o,x]=c.useState(),h=D("(min-width: 768px)"),v=g=>{const{name:y,value:C}=g.target;t({[y]:C})},u=async g=>{if(g.preventDefault(),!(r!=null&&r.name)){x("Veuillez renseigner le nom de la catégorie.");return}n(!0);try{await d(r)}catch{x("Une erreur est survenue, veuillez réessayer plus tard.")}n(!1),m(!1)};return c.useEffect(()=>{f||t()},[f]),h?e.jsxs(k,{open:f,onOpenChange:m,children:[e.jsx(S,{asChild:!0,children:e.jsx(i,{variant:"link",className:"p-0 h-min",children:"Ajouter une catégorie"})}),e.jsxs(F,{className:"sm:max-w-[425px]",children:[e.jsxs(z,{children:[e.jsx(M,{children:"Ajouter une catégorie"}),e.jsx(T,{children:"Définissez un nom pour ajouter une catégorie."})]}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{children:[e.jsx(p,{htmlFor:"name",children:"Nom"}),e.jsx(N,{id:"name",name:"name",type:"text",onChange:v})]})}),o&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:o}),e.jsx(E,{className:"sm:justify-start",children:e.jsx(O,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(i,{variant:"outline",onClick:()=>t(),children:"Annuler"}),e.jsx(i,{onClick:u,disabled:l&&!0,children:l?e.jsx(b,{className:"animate-spin"}):"Ajouter"})]})})})]})]}):e.jsxs(L,{open:f,onOpenChange:m,children:[e.jsx(R,{asChild:!0,children:e.jsx(i,{variant:"link",className:"p-0 h-min",children:"Ajouter une catégorie"})}),e.jsxs(V,{children:[e.jsxs(P,{className:"text-left",children:[e.jsx(I,{children:"Ajouter une categorie"}),e.jsx(U,{children:"Définissez un nom pour ajouter une categorie."})]}),e.jsx("div",{className:"flex flex-col px-4 gap-2",children:e.jsxs("div",{children:[e.jsx(p,{htmlFor:"name",children:"Nom"}),e.jsx(N,{id:"name",name:"name",type:"text",onChange:v})]})}),e.jsxs($,{className:"pt-2",children:[o&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:o}),e.jsx(H,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"w-full",onClick:u,disabled:l&&!0,children:l?e.jsx(b,{className:"animate-spin"}):"Ajouter"}),e.jsx(i,{className:"w-full",variant:"outline",onClick:()=>t(),children:"Annuler"})]})})]})]})]})},q=c.forwardRef(({className:d,...f},m)=>e.jsx("textarea",{className:Q("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",d),ref:m,...f}));q.displayName="Textarea";const te=({providerCategoryId:d,createService:f})=>{const[m,r]=c.useState(!1),[t,l]=c.useState(),[n,o]=c.useState(!1),[x,h]=c.useState(),v=D("(min-width: 768px)"),u=y=>{const{name:C,value:w}=y.target,A=C==="price"||C==="duration"?parseFloat(w):w;l({...t,[C]:A})},g=async y=>{if(y.preventDefault(),!(t!=null&&t.name)||!(t!=null&&t.price)||!(t!=null&&t.duration)){h("Veuillez renseigner tous les champs.");return}o(!0);try{await f({providerCategoryId:d,...t})}catch{h("Une erreur est survenue, veuillez réessayer plus tard.")}o(!1),r(!1)};return c.useEffect(()=>{m||l()},[m]),v?e.jsxs(k,{open:m,onOpenChange:r,children:[e.jsx(S,{asChild:!0,children:e.jsx(i,{variant:"outline",children:e.jsx(B,{})})}),e.jsxs(F,{className:"sm:max-w-[425px]",children:[e.jsxs(z,{children:[e.jsx(M,{children:"Ajouter une prestation"}),e.jsx(T,{children:"Définissez un nom, un prix et une durée pour ajouter une prestation."})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"name",children:"Nom"}),e.jsx(N,{id:"name",name:"name",type:"text",onChange:u})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"price",children:"Prix (en €)"}),e.jsx(N,{id:"price",name:"price",type:"number",onChange:u})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"duration",children:"Durée (en minutes)"}),e.jsx(N,{id:"duration",name:"duration",type:"number",onChange:u})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"description",children:"Description"}),e.jsx(q,{id:"description",name:"description",className:"resize-none",onChange:u})]})]}),x&&setTimeout(()=>h(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:x}),e.jsx(E,{className:"sm:justify-start",children:e.jsx(O,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(i,{variant:"outline",onClick:()=>l(),children:"Annuler"}),e.jsx(i,{onClick:g,disabled:n&&!0,children:n?e.jsx(b,{className:"animate-spin"}):"Ajouter"})]})})})]})]}):e.jsxs(L,{open:m,onOpenChange:r,children:[e.jsx(R,{asChild:!0,children:e.jsx(i,{variant:"outline",children:e.jsx(B,{})})}),e.jsxs(V,{children:[e.jsxs(P,{className:"text-left",children:[e.jsx(I,{children:"Ajouter une prestation"}),e.jsx(U,{children:"Définissez un nom, un prix et une durée pour ajouter une prestation."})]}),e.jsxs("div",{className:"flex flex-col px-4 gap-2",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"name",children:"Nom"}),e.jsx(N,{id:"name",name:"name",type:"text",onChange:u})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"price",children:"Prix"}),e.jsx(N,{id:"price",name:"price",type:"number",onChange:u})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"duration",children:"Durée"}),e.jsx(N,{id:"duration",name:"duration",type:"number",onChange:u})]})]}),e.jsxs($,{className:"pt-2",children:[x&&setTimeout(()=>h(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:x}),e.jsx(H,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"w-full",onClick:g,disabled:n&&!0,children:n?e.jsx(b,{className:"animate-spin"}):"Ajouter"}),e.jsx(i,{className:"w-full",variant:"outline",onClick:()=>l(),children:"Annuler"})]})})]})]})]})},ae=({id:d,name:f,disableCategory:m})=>{const[r,t]=c.useState(!1),[l,n]=c.useState(!1),[o,x]=c.useState(),h=D("(min-width: 768px)"),v=async u=>{u.preventDefault(),n(!0);try{await m(d)}catch{x("Une erreur est survenue, veuillez réessayer plus tard.")}n(!1),t(!1)};return h?e.jsxs(k,{open:r,onOpenChange:t,children:[e.jsx(S,{asChild:!0,children:e.jsx(i,{variant:"ghost",className:"ml-2",children:e.jsx(G,{className:"text-destructive"})})}),e.jsxs(F,{className:"sm:max-w-[425px]",children:[e.jsxs(z,{children:[e.jsx(M,{className:"text-destructive",children:"Retirer la catégorie"}),e.jsx(T,{children:"Toutes les prestations associées seront retirées."})]}),o&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:o}),e.jsx(E,{className:"sm:justify-start",children:e.jsx(O,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(i,{variant:"outline",children:"Annuler"}),e.jsx(i,{onClick:v,variant:"destructive",disabled:l&&!0,children:l?e.jsx(b,{className:"animate-spin"}):"Retirer"})]})})})]})]}):e.jsxs(L,{open:r,onOpenChange:t,children:[e.jsx(R,{asChild:!0,children:e.jsx(i,{variant:"ghost",className:"ml-2",children:e.jsx(G,{className:"text-destructive"})})}),e.jsxs(V,{children:[e.jsxs(P,{className:"text-left",children:[e.jsx(I,{className:"text-destructive",children:"Retirer la catégorie"}),e.jsx(U,{children:"Toutes les prestations associées seront retirées."})]}),e.jsxs($,{className:"pt-2",children:[o&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:o}),e.jsx(H,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"w-full",onClick:v,variant:"destructive",disabled:l&&!0,children:l?e.jsx(b,{className:"animate-spin"}):"Retirer"}),e.jsx(i,{className:"w-full",variant:"outline",children:"Annuler"})]})})]})]})]})},re=({id:d,providerCategoryId:f,disableService:m})=>{const[r,t]=c.useState(!1),[l,n]=c.useState(!1),[o,x]=c.useState(),h=D("(min-width: 768px)"),v=async u=>{u.preventDefault(),n(!0);try{await m(d,f)}catch{x("Une erreur est survenue, veuillez réessayer plus tard.")}n(!1),t(!1)};return h?e.jsxs(k,{open:r,onOpenChange:t,children:[e.jsx(S,{asChild:!0,children:e.jsx(i,{variant:"destructive",children:"Retirer"})}),e.jsxs(F,{className:"sm:max-w-[425px]",children:[e.jsxs(z,{children:[e.jsx(M,{className:"text-destructive",children:"Retirer la prestation"}),e.jsx(T,{children:"Êtes-vous sûr de vouloir retirer cette prestation ?"})]}),o&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:o}),e.jsx(E,{className:"sm:justify-start",children:e.jsx(O,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(i,{variant:"outline",children:"Annuler"}),e.jsx(i,{onClick:v,variant:"destructive",disabled:l&&!0,children:l?e.jsx(b,{className:"animate-spin"}):"Retirer"})]})})})]})]}):e.jsxs(L,{open:r,onOpenChange:t,children:[e.jsx(R,{asChild:!0,children:e.jsx(i,{variant:"destructive",children:"Retirer"})}),e.jsxs(V,{children:[e.jsxs(P,{className:"text-left",children:[e.jsx(I,{className:"text-destructive",children:"Retirer la prestation"}),e.jsx(U,{children:"Êtes-vous sûr de vouloir retirer cette prestation ?"})]}),e.jsxs($,{className:"pt-2",children:[o&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:o}),e.jsx(H,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"w-full",onClick:v,variant:"destructive",disabled:l&&!0,children:l?e.jsx(b,{className:"animate-spin"}):"Retirer"}),e.jsx(i,{className:"w-full",variant:"outline",children:"Annuler"})]})})]})]})]})},ne=({prevService:d,updateService:f})=>{const[m,r]=c.useState(!1),[t,l]=c.useState(),[n,o]=c.useState(!1),[x,h]=c.useState(),v=D("(min-width: 768px)"),u=y=>{const{name:C,value:w}=y.target,A=C==="price"||C==="duration"?parseFloat(w):w;l({...t,[C]:A})},g=async y=>{if(y.preventDefault(),o(!0),!Object.keys(t).some(w=>t[w]!==d[w])){o(!1),r(!1);return}try{await f(d.id,t)}catch{h("Une erreur est survenue, veuillez réessayer plus tard.")}o(!1),r(!1)};return c.useEffect(()=>{m||l()},[m]),v?e.jsxs(k,{open:m,onOpenChange:r,children:[e.jsx(S,{asChild:!0,children:e.jsx(i,{variant:"outline",children:"Modifier"})}),e.jsxs(F,{className:"sm:max-w-[425px]",children:[e.jsxs(z,{children:[e.jsx(M,{children:"Modifier la prestation"}),e.jsx(T,{children:"Modifiez les détails de la prestation."})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"name",children:"Nom"}),e.jsx(N,{id:"name",name:"name",type:"text",defaultValue:d.name,onChange:u})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"price",children:"Prix (en €)"}),e.jsx(N,{id:"price",name:"price",type:"number",defaultValue:d.price,onChange:u})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"duration",children:"Durée (en minutes)"}),e.jsx(N,{id:"duration",name:"duration",type:"number",defaultValue:d.duration,onChange:u})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"description",children:"Description"}),e.jsx(q,{id:"description",name:"description",className:"resize-none",defaultValue:d.description,onChange:u})]})]}),x&&setTimeout(()=>h(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:x}),e.jsx(E,{className:"sm:justify-start",children:e.jsx(O,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(i,{variant:"outline",onClick:()=>l(),children:"Annuler"}),e.jsx(i,{onClick:g,disabled:n&&!0,children:n?e.jsx(b,{className:"animate-spin"}):"Modifier"})]})})})]})]}):e.jsxs(L,{open:m,onOpenChange:r,children:[e.jsx(R,{asChild:!0,children:e.jsx(i,{variant:"outline",children:"Modifier"})}),e.jsxs(V,{children:[e.jsxs(P,{className:"text-left",children:[e.jsx(I,{children:" Modifier la prestation"}),e.jsx(U,{children:"Modifiez les détails de la prestation."})]}),e.jsxs("div",{className:"flex flex-col px-4 gap-2",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"name",children:"Nom"}),e.jsx(N,{id:"name",name:"name",type:"text",defaultValue:d.name,onChange:u})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"price",children:"Prix"}),e.jsx(N,{id:"price",name:"price",type:"number",defaultValue:d.price,onChange:u})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"duration",children:"Durée"}),e.jsx(N,{id:"duration",name:"duration",type:"number",defaultValue:d.duration,onChange:u})]})]}),e.jsxs($,{className:"pt-2",children:[x&&setTimeout(()=>h(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:x}),e.jsx(H,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"w-full",onClick:g,disabled:n&&!0,children:n?e.jsx(b,{className:"animate-spin"}):"Modifier"}),e.jsx(i,{className:"w-full",variant:"outline",onClick:()=>l(),children:"Annuler"})]})})]})]})]})},oe=()=>{const[d,f]=c.useState(),[m,r]=c.useState(),[t,l]=c.useState(!0),n=W(),o=X(),x=Y();c.useEffect(()=>{h()},[]);async function h(){var s;try{const a=await n.get("/api/providerCategory/me");f(a.data.sort((j,K)=>j.name.localeCompare(K.name)))}catch(a){((s=a.response)==null?void 0:s.status)===401?o("/login",{state:{from:x},replace:!0}):setError(a)}l(!1)}async function v(s){try{await n.post("/api/providerService",s),h()}catch(a){r(a)}}async function u(s){try{await n.post("/api/providerCategory",s),h()}catch(a){r(a)}}async function g(s){try{await n.put(`/api/providerService/${s}`,{isActive:!0}),h()}catch(a){r(a)}}async function y(s){try{await n.put(`/api/providerCategory/${s}`,{isActive:!0}),h()}catch(a){r(a)}}async function C(s,a){console.log(a);try{await n.put(`/api/providerService/${s}`,a),h()}catch(j){r(j)}}async function w(s,a){try{await n.put(`/api/providerService/${s}`,{isActive:!1,providerCategoryId:a}),h()}catch(j){r(j)}}async function A(s){try{await n.put(`/api/providerCategory/${s}`,{isActive:!1}),h()}catch(a){r(a)}}return t?e.jsx(b,{className:"w-8 h-8 animate-spin flex-1"}):e.jsxs("main",{className:"w-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col space-y-4",children:[e.jsx(i,{variant:"link",className:"justify-start h-0 p-0",onClick:()=>o(-1),children:"Retour"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold",children:"Mes prestations"}),e.jsx(ie,{createCategory:u})]}),d==null?void 0:d.map(s=>s.isActive&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-medium",children:s.name}),e.jsxs("div",{children:[e.jsx(te,{providerCategoryId:s.id,createService:v}),e.jsx(ae,{id:s.id,name:s.name,disableCategory:A})]})]}),e.jsx("ul",{className:"space-y-2",children:s.services.map(a=>a.isActive&&e.jsx("li",{className:"flex items-center justify-between gap-4",children:e.jsx("div",{className:"w-full rounded-md p-4 pr-0 bg-gray-100",children:e.jsxs("div",{className:"flex items-start justify-between gap-10",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl",children:a.name}),e.jsx("p",{children:a.description})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("p",{children:[a.duration,"mn"]}),e.jsx("div",{className:"divider divider-horizontal"}),e.jsxs("p",{children:[a.price,"€"]}),e.jsxs(Z,{children:[e.jsx(_,{children:e.jsx(i,{variant:"ghost",className:"ml-4",children:e.jsx(se,{})})}),e.jsxs(ee,{className:"w-fit flex flex-col gap-2",children:[e.jsx(ne,{prevService:a,updateService:C}),e.jsx(re,{id:a.id,providerCategoryId:s.id,disableService:w})]})]})]})]})})},a.id))})]},s.id)),e.jsx("div",{className:"divider divider-start text-muted",children:"Inactives"}),d.map(s=>(s.services.some(j=>!j.isActive)||!s.isActive)&&e.jsxs("div",{className:"space-y-2 text-muted",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-medium",children:s.name}),!s.isActive&&e.jsx(i,{variant:"link",onClick:()=>y(s.id),children:"Activer la catégorie"})]}),e.jsx("ul",{className:"space-y-2",children:s.services.map(j=>(!j.isActive||!s.isActive)&&e.jsx("li",{className:"flex items-center justify-between gap-4",children:e.jsxs("div",{className:"w-full rounded-md p-4 bg-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{children:j.name}),s.isActive&&!j.isActive&&e.jsx(i,{variant:"link",onClick:()=>g(j.id),children:"Activer le service"}),!s.isActive&&e.jsxs("div",{className:"flex items-center",children:[e.jsxs("p",{children:[j.duration,"mn"]}),e.jsx("div",{className:"divider divider-horizontal"}),e.jsxs("p",{children:[j.price,"€"]})]})]}),e.jsx("p",{children:j.description})]})},j.id))})]},s.id)),e.jsxs("p",{className:"text-sm text-muted",children:["La suppression des catégories et services est restreinte afin d'améliorer l'analyse de l'activité. ",e.jsx("br",{})," Pour supprimer définitivement une catégorie ou un service, veuillez"," ",e.jsxs(i,{variant:"link",className:"pl-0",children:[e.jsx("a",{href:"mailto:mlamins.ngom@gmail.com",children:"contacter le support"}),"."]})]})]})};export{oe as default};
