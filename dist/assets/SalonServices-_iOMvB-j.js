import{r as i,m as D,j as e,D as S,n as b,B as a,o as A,p as k,q as F,s as E,I as p,t as L,v as T,L as g,w as z,x as O,y as M,z as P,A as H,C as I,F as R,G as B,H as V,u as q,a as G,b as Q,E as $}from"./index-CP035eP3.js";import{L as f}from"./label-BBwN9drT.js";import{C as w,a as y}from"./circle-plus-PjF4zBRw.js";const J=({providerCategoryId:j,createService:v})=>{const[d,o]=i.useState(!1),[s,u]=i.useState(),[r,x]=i.useState(!1),[h,n]=i.useState(),N=D("(min-width: 768px)"),m=c=>{const{name:l,value:C}=c.target,U=l==="price"||l==="duration"?parseFloat(C):C;u({...s,[l]:U})},t=async c=>{if(console.log("submitting"),c.preventDefault(),!(s!=null&&s.name)||!(s!=null&&s.price)||!(s!=null&&s.duration)){n("Veuillez renseigner tous les champs.");return}x(!0);try{await v({providerCategoryId:j,...s})}catch{n("Une erreur est survenue, veuillez réessayer plus tard.")}x(!1),o(!1)};return i.useEffect(()=>{d||u()},[d]),N?e.jsxs(S,{open:d,onOpenChange:o,children:[e.jsx(b,{asChild:!0,children:e.jsx(a,{children:e.jsx(w,{})})}),e.jsxs(A,{className:"sm:max-w-[425px]",children:[e.jsxs(k,{children:[e.jsx(F,{children:"Ajouter une prestation"}),e.jsx(E,{children:"Définissez un nom, un prix et une durée pour ajouter une prestation."})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{children:[e.jsx(f,{htmlFor:"name",children:"Nom"}),e.jsx(p,{id:"name",name:"name",type:"text",onChange:m})]}),e.jsxs("div",{children:[e.jsx(f,{htmlFor:"price",children:"Prix"}),e.jsx(p,{id:"price",name:"price",type:"number",onChange:m})]}),e.jsxs("div",{children:[e.jsx(f,{htmlFor:"duration",children:"Durée"}),e.jsx(p,{id:"duration",name:"duration",type:"number",onChange:m})]})]}),h&&setTimeout(()=>n(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:h}),e.jsx(L,{className:"sm:justify-start",children:e.jsx(T,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(a,{variant:"outline",onClick:()=>u(),children:"Annuler"}),e.jsx(a,{onClick:t,disabled:r&&!0,children:r?e.jsx(g,{className:"animate-spin"}):"Ajouter"})]})})})]})]}):e.jsxs(z,{open:d,onOpenChange:o,children:[e.jsx(O,{asChild:!0,children:e.jsx(a,{children:e.jsx(w,{})})}),e.jsxs(M,{children:[e.jsxs(P,{className:"text-left",children:[e.jsx(H,{children:"Ajouter une prestation"}),e.jsx(I,{children:"Définissez un nom, un prix et une durée pour ajouter une prestation."})]}),e.jsxs("div",{className:"flex flex-col px-4 gap-2",children:[e.jsxs("div",{children:[e.jsx(f,{htmlFor:"name",children:"Nom"}),e.jsx(p,{id:"name",name:"name",type:"text",onChange:m})]}),e.jsxs("div",{children:[e.jsx(f,{htmlFor:"price",children:"Prix"}),e.jsx(p,{id:"price",name:"price",type:"number",onChange:m})]}),e.jsxs("div",{children:[e.jsx(f,{htmlFor:"duration",children:"Durée"}),e.jsx(p,{id:"duration",name:"duration",type:"number",onChange:m})]})]}),e.jsxs(R,{className:"pt-2",children:[h&&setTimeout(()=>n(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:h}),e.jsx(B,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{className:"w-full",onClick:t,disabled:r&&!0,children:r?e.jsx(g,{className:"animate-spin"}):"Ajouter"}),e.jsx(a,{className:"w-full",variant:"outline",onClick:()=>u(),children:"Annuler"})]})})]})]})]})},K=({id:j,removeService:v})=>{const[d,o]=i.useState(!1),[s,u]=i.useState(!1),[r,x]=i.useState(),h=D("(min-width: 768px)"),n=async N=>{N.preventDefault(),u(!0);try{await v(j)}catch{x("Une erreur est survenue, veuillez réessayer plus tard.")}u(!1),o(!1)};return h?e.jsxs(S,{open:d,onOpenChange:o,children:[e.jsx(b,{asChild:!0,children:e.jsx(a,{variant:"outline",children:e.jsx(y,{className:"text-destructive"})})}),e.jsxs(A,{className:"sm:max-w-[425px]",children:[e.jsxs(k,{children:[e.jsx(F,{className:"text-destructive",children:"Supprimer une prestation"}),e.jsx(E,{children:"Êtes-vous sûr de vouloir supprimer cette prestation ?"})]}),r&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:r}),e.jsx(L,{className:"sm:justify-start",children:e.jsx(T,{asChild:!0,children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(a,{variant:"outline",children:"Annuler"}),e.jsx(a,{onClick:n,variant:"destructive",disabled:s&&!0,children:s?e.jsx(g,{className:"animate-spin"}):"Supprimer"})]})})})]})]}):e.jsxs(z,{open:d,onOpenChange:o,children:[e.jsx(O,{asChild:!0,children:e.jsx(a,{variant:"outline",children:e.jsx(y,{className:"text-destructive"})})}),e.jsxs(M,{children:[e.jsxs(P,{className:"text-left",children:[e.jsx(H,{className:"text-destructive",children:"Supprimer une prestation"}),e.jsx(I,{children:"Êtes-vous sûr de vouloir supprimer cette prestation ?"})]}),e.jsxs(R,{className:"pt-2",children:[r&&setTimeout(()=>x(null),3e3)&&e.jsx("p",{className:"text-destructive text-sm",children:r}),e.jsx(B,{asChild:!0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{className:"w-full",onClick:n,variant:"destructive",disabled:s&&!0,children:s?e.jsx(g,{className:"animate-spin"}):"Supprimer"}),e.jsx(a,{className:"w-full",variant:"outline",children:"Annuler"})]})})]})]})]})},Z=()=>{const[j,v]=i.useState(),[d,o]=i.useState(),[s,u]=i.useState(!0);V();const r=q(),x=G(),h=Q();i.useEffect(()=>{n()},[]);async function n(){var t;try{const c=await r.get("/api/providerCategory/me");v(c.data)}catch(c){o(c),((t=c.response)==null?void 0:t.status)===401&&x("/login",{state:{from:h},replace:!0})}u(!1)}async function N(t){await r.post("/api/providerService",t),n()}async function m(t){await r.delete(`/api/providerService/${t}`),n()}return s?e.jsx(g,{className:"w-8 h-8 animate-spin flex-1"}):d?e.jsx($,{}):e.jsxs("main",{className:"w-full max-w-screen-md mx-auto p-6 flex flex-1 flex-col space-y-4",children:[e.jsx(a,{variant:"link",className:"justify-start h-0 p-0",onClick:()=>x(-1),children:"Retour"}),e.jsx("h1",{className:"text-3xl font-semibold",children:"Mes prestations"}),j==null?void 0:j.map((t,c)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-medium",children:t.name}),e.jsx(J,{providerCategoryId:t.id,createService:N})]}),e.jsx("ul",{className:"space-y-2",children:t.services.map(l=>e.jsxs("li",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"w-full rounded-md p-4 bg-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{children:l.name}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("p",{children:[l.duration,"mn"]}),e.jsx("div",{className:"divider divider-horizontal"}),e.jsxs("p",{children:[l.price,"€"]})]})]}),e.jsx("p",{children:l.description})]}),e.jsx(K,{id:l.id,removeService:m})]},l.id))})]},c))]})};export{Z as default};
